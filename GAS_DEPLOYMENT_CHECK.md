# Google Apps Script デプロイ確認事項

## 1. スプレッドシートの準備

1. Google スプレッドシートを開く
2. 拡張機能 → Apps Script を開く

## 2. GASコードの貼り付け

`gas-code.gs`の内容をすべてコピーしてApps Scriptエディタに貼り付けてください。

## 3. デプロイ手順

1. **保存**: コードを保存（Ctrl+S または Cmd+S）

2. **デプロイ**:
   - 右上の「デプロイ」ボタンをクリック
   - 「新しいデプロイ」を選択

3. **設定**:
   - 種類: 「ウェブアプリ」を選択
   - 説明: 任意（例：「お問い合わせフォーム」）
   - 実行ユーザー: **「自分」を選択**
   - アクセスできるユーザー: **「全員」を選択**

4. **デプロイ**: 「デプロイ」ボタンをクリック

5. **承認**:
   - 「アクセスを承認」をクリック
   - Googleアカウントを選択
   - 「詳細」をクリック → 「安全でないページに移動」
   - 必要な権限を承認

6. **URL取得**:
   - デプロイ完了後、Web App URLをコピー
   - URLは以下の形式：
     ```
     https://script.google.com/macros/s/xxxxxx/exec
     ```

## 4. contact-handler-gas.js の更新

現在のURL:
```javascript
this.gasEndpoint = 'https://script.google.com/macros/s/AKfycbxufN4CPujE75vKqgeMqKMhumfFm9HE4j4pN0sZMSaKJGXS7wP5vp6P1d5jKgz8LIne/exec';
```

このURLが正しいデプロイURLと一致しているか確認してください。

## 5. デバッグ方法

### A. GAS側でテスト

Apps Scriptエディタで：
1. `testDoPost`関数を選択
2. 実行ボタンをクリック
3. 実行ログを確認

### B. スプレッドシートの確認

1. スプレッドシートに「お問い合わせ」シートが自動作成されているか確認
2. ヘッダー行が正しく設定されているか確認

### C. 実行ログの確認

Apps Script エディタ：
- 表示 → 実行ログ
- エラーメッセージを確認

## 6. よくある問題と解決策

### 問題1: 権限エラー
- **解決**: デプロイ時の承認プロセスを完了する

### 問題2: URLが違う
- **解決**: 最新のデプロイURLをコピーして、contact-handler-gas.jsを更新

### 問題3: スプレッドシートが見つからない
- **解決**: GASコードがスプレッドシートに紐付いているか確認

### 問題4: CORSエラー
- **解決**: 
  - アクセス設定が「全員」になっているか確認
  - no-corsモードが正しく設定されているか確認

## 7. 再デプロイが必要な場合

1. Apps Scriptエディタでコードを修正
2. 保存
3. デプロイ → デプロイを管理
4. 編集（鉛筆アイコン）をクリック
5. バージョン: 「新バージョン」を選択
6. デプロイ

## 8. 動作確認

1. ブラウザのコンソールを開く（F12）
2. フォームを送信
3. エラーメッセージを確認
4. スプレッドシートを更新して、データが入っているか確認