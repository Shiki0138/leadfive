<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="baseurl" content="">
  
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>ğŸš€ å®Œå…¨ç‰ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ AIãƒ–ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ  - Google Apps Script | AIÃ—å¿ƒç†å­¦ã§å£²ä¸Šã‚’ç§‘å­¦ã™ã‚‹ Leadfive</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="ğŸš€ å®Œå…¨ç‰ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ AIãƒ–ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ  - Google Apps Script" />
<meta property="og:locale" content="ja" />
<meta name="description" content="äººé–“ã®8ã¤ã®æœ¬èƒ½ã‚’ç†è§£ã—ã€AIã§æœ€é©åŒ–ã€‚äºˆæ¸¬å¯èƒ½ãªæˆé•·ã‚’ã‚ãªãŸã®ãƒ“ã‚¸ãƒã‚¹ã«ã€‚" />
<meta property="og:description" content="äººé–“ã®8ã¤ã®æœ¬èƒ½ã‚’ç†è§£ã—ã€AIã§æœ€é©åŒ–ã€‚äºˆæ¸¬å¯èƒ½ãªæˆé•·ã‚’ã‚ãªãŸã®ãƒ“ã‚¸ãƒã‚¹ã«ã€‚" />
<link rel="canonical" href="https://leadfive138.com/docs/COMPLETE_PREMIUM_SYSTEM_CODE/" />
<meta property="og:url" content="https://leadfive138.com/docs/COMPLETE_PREMIUM_SYSTEM_CODE/" />
<meta property="og:site_name" content="AIÃ—å¿ƒç†å­¦ã§å£²ä¸Šã‚’ç§‘å­¦ã™ã‚‹ Leadfive" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="ğŸš€ å®Œå…¨ç‰ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ AIãƒ–ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ  - Google Apps Script" />
<meta name="twitter:site" content="@leadfive" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"äººé–“ã®8ã¤ã®æœ¬èƒ½ã‚’ç†è§£ã—ã€AIã§æœ€é©åŒ–ã€‚äºˆæ¸¬å¯èƒ½ãªæˆé•·ã‚’ã‚ãªãŸã®ãƒ“ã‚¸ãƒã‚¹ã«ã€‚","headline":"ğŸš€ å®Œå…¨ç‰ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ AIãƒ–ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ  - Google Apps Script","url":"https://leadfive138.com/docs/COMPLETE_PREMIUM_SYSTEM_CODE/"}</script>
<!-- End Jekyll SEO tag -->

  
  <!-- Critical CSS for faster mobile loading -->
  <style>
    /* Critical CSS */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Noto Sans JP', sans-serif; background-color: #0a0a0a; color: #ffffff; }
    body.blog-page { background-color: #ffffff; color: #374151; }
    .site-header { position: fixed; top: 0; left: 0; right: 0; z-index: 1000; background: rgba(10, 10, 10, 0.8); backdrop-filter: blur(10px); }
    body.blog-page .site-header { background: #1e3a8a !important; border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important; }
    body.blog-page .navbar, body.blog-page nav.navbar { background: #1e3a8a !important; background-color: #1e3a8a !important; }
    body.blog-page .nav-link, body.blog-page nav.navbar .nav-link, body.blog-page nav.navbar a, body.blog-page .navbar a { color: #ffffff !important; background-color: #1e3a8a !important; background: #1e3a8a !important; padding: 0.5rem 1rem !important; border-radius: 6px !important; margin: 0 0.2rem !important; border: none !important; text-shadow: none !important; }
    body.blog-page .navbar-nav .nav-item .nav-link { color: #ffffff !important; background-color: #1e3a8a !important; background: #1e3a8a !important; }
    body.blog-page a.nav-link { color: #ffffff !important; background-color: #1e3a8a !important; background: #1e3a8a !important; }
    .blog-page .nav-link { color: #ffffff !important; background-color: #1e3a8a !important; background: #1e3a8a !important; }
    body.blog-page .navbar-nav { background: transparent !important; }
    body.blog-page .navbar-menu { background: transparent !important; }
    body.blog-page .navbar-brand .logo-text { color: #ffffff !important; -webkit-text-fill-color: #ffffff !important; }
    .navbar { padding: 1rem 0; }
    .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
    .btn { display: inline-block; padding: 0.75rem 2rem; border: none; border-radius: 9999px; font-weight: 600; text-decoration: none; cursor: pointer; transition: all 0.3s ease; }
    .btn-primary { background: linear-gradient(135deg, #8b5cf6, #ec4899); color: #ffffff; }
    @media (max-width: 768px) { .container { padding: 0 15px; } }
  </style>
  
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700;900&display=swap" rel="stylesheet">
  
  
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-KFLZV7QS');</script>
  <!-- End Google Tag Manager -->
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KFLZV7QS"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  
  <header class="site-header" >
  <nav class="navbar">
    <div class="container">
      <div class="navbar-brand">
        <a href="/" class="logo">
          <span class="logo-text" >LeadFive</span>
        </a>
      </div>
      
      <button class="navbar-toggler" id="navbarToggler" aria-label="Toggle navigation">
        <span></span>
        <span></span>
        <span></span>
      </button>
      
      <div class="navbar-menu" id="navbarMenu">
        
        <!-- Regular navigation for non-blog pages -->
        <ul class="navbar-nav">
          <li class="nav-item">
            <a href="/#philosophy" class="nav-link">ç†å¿µ</a>
          </li>
          <li class="nav-item">
            <a href="/#services" class="nav-link">ã‚µãƒ¼ãƒ“ã‚¹</a>
          </li>
          <li class="nav-item">
            <a href="/#case-studies" class="nav-link">å®Ÿç¸¾</a>
          </li>
          <li class="nav-item">
            <a href="/blog/" class="nav-link">ãƒ–ãƒ­ã‚°</a>
          </li>
          <li class="nav-item">
            <a href="/company/" class="nav-link">ä¼šç¤¾æ¦‚è¦</a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" onclick="openContactForm(); return false;">ãŠå•ã„åˆã‚ã›</a>
          </li>
        </ul>
        
      </div>
    </div>
  </nav>
</header>

<!-- Mobile menu is handled by main.js -->
  
  <main>
    <h1 id="-å®Œå…¨ç‰ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ aiãƒ–ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ ---google-apps-script">ğŸš€ å®Œå…¨ç‰ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ AIãƒ–ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ  - Google Apps Script</h1>

<h2 id="æœ€çµ‚å®Œæˆç‰ˆã‚³ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆé–¢æ•°å‰Šé™¤æ¸ˆã¿">æœ€çµ‚å®Œæˆç‰ˆã‚³ãƒ¼ãƒ‰ï¼ˆãƒ†ã‚¹ãƒˆé–¢æ•°å‰Šé™¤æ¸ˆã¿ï¼‰</h2>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ===== ãƒ—ãƒ¬ãƒŸã‚¢ãƒ  AI ãƒ–ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ è¨­å®š =====</span>
<span class="kd">const</span> <span class="nx">CONFIG</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">recipientEmail</span><span class="p">:</span> <span class="dl">'</span><span class="s1">greenroom51@gmail.com</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">githubOwner</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Shiki0138</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">githubRepo</span><span class="p">:</span> <span class="dl">'</span><span class="s1">leadfive</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">botName</span><span class="p">:</span> <span class="dl">'</span><span class="s1">LeadFive Premium AI</span><span class="dl">'</span><span class="p">,</span>
  
  <span class="c1">// APIè¨­å®š</span>
  <span class="na">anthropicApiKey</span><span class="p">:</span> <span class="nx">PropertiesService</span><span class="p">.</span><span class="nx">getScriptProperties</span><span class="p">().</span><span class="nx">getProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">ANTHROPIC_API_KEY</span><span class="dl">'</span><span class="p">),</span>
  <span class="na">unsplashApiKey</span><span class="p">:</span> <span class="nx">PropertiesService</span><span class="p">.</span><span class="nx">getScriptProperties</span><span class="p">().</span><span class="nx">getProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">UNSPLASH_ACCESS_KEY</span><span class="dl">'</span><span class="p">),</span>
  <span class="na">githubToken</span><span class="p">:</span> <span class="nx">PropertiesService</span><span class="p">.</span><span class="nx">getScriptProperties</span><span class="p">().</span><span class="nx">getProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">GITHUB_TOKEN</span><span class="dl">'</span><span class="p">),</span>
  
  <span class="c1">// ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¨­å®š</span>
  <span class="na">blogBaseUrl</span><span class="p">:</span> <span class="dl">'</span><span class="s1">https://shiki0138.github.io/leadfive</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">imageWidth</span><span class="p">:</span> <span class="mi">1200</span><span class="p">,</span>
  <span class="na">imageHeight</span><span class="p">:</span> <span class="mi">630</span>
<span class="p">};</span>

<span class="c1">// ===== ğŸ—“ï¸ é€±æ¬¡ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä¼ç”»ã‚·ã‚¹ãƒ†ãƒ  =====</span>
<span class="kd">function</span> <span class="nx">createWeeklyContentPlan</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">startDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">weekNumber</span> <span class="o">=</span> <span class="nx">getWeekNumber</span><span class="p">(</span><span class="nx">startDate</span><span class="p">);</span>
  
  <span class="kd">const</span> <span class="nx">weeklyThemes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="na">theme</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ChatGPTæ´»ç”¨é€±é–“</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">focus</span><span class="p">:</span> <span class="dl">"</span><span class="s2">AIãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">dailyTopics</span><span class="p">:</span> <span class="p">[</span>
        <span class="dl">"</span><span class="s2">ChatGPT-4ã§ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°æˆ¦ç•¥ã‚’é©æ–°ã™ã‚‹5ã¤ã®æ–¹æ³•</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">AIãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¨­è¨ˆã§é¡§å®¢å¿ƒç†ã‚’èª­ã¿è§£ãæŠ€è¡“</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">ChatGPTã¨GA4é€£æºã«ã‚ˆã‚‹å£²ä¸Šäºˆæ¸¬ã‚·ã‚¹ãƒ†ãƒ </span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">AIÃ—å¿ƒç†å­¦ã§ä½œã‚‹å®Œç’§ãªãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">ChatGPTæ´»ç”¨äº‹ä¾‹ï¼šç¾å®¹ã‚µãƒ­ãƒ³ã®å£²ä¸Š3å€é”æˆæ³•</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">AIã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒ¼ãƒ“ã‚¹ã§é¡§å®¢æº€è¶³åº¦200%å‘ä¸Š</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">é€±æœ«ç‰¹åˆ¥ï¼šChatGPTãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ç·ã¾ã¨ã‚ï¼‹æ¥é€±äºˆå‘Š</span><span class="dl">"</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="na">theme</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ç¾å®¹æ¥­ç•ŒAIé©å‘½é€±é–“</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">focus</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ç¾å®¹æ¥­ç•Œ</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">dailyTopics</span><span class="p">:</span> <span class="p">[</span>
        <span class="dl">"</span><span class="s2">ç¾å®¹æ¥­ç•Œã®SNSæˆ¦ç•¥ã‚’AIã§å®Œå…¨è‡ªå‹•åŒ–ã™ã‚‹æ–¹æ³•</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">é¡§å®¢ã®è‚Œè³ªã‚’AIåˆ†æã—ã¦å£²ä¸Šã‚¢ãƒƒãƒ—ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ </span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">ç¾å®¹ã‚µãƒ­ãƒ³ã®äºˆç´„ç‡ã‚’3å€ã«ã™ã‚‹AIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">ã‚¤ãƒ³ã‚¹ã‚¿æ˜ ãˆå†™çœŸã‚’AIã§è‡ªå‹•ç”Ÿæˆã™ã‚‹ãƒ„ãƒ¼ãƒ«</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">ç¾å®¹æ¥­ç•Œã®å£ã‚³ãƒŸåˆ†æã§ç«¶åˆã«å‹ã¤AIæˆ¦ç•¥</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">AIãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã§é¡§å®¢å˜ä¾¡å‘ä¸Š</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">é€±æœ«ç·æ‹¬ï¼šç¾å®¹Ã—AIæœ€æ–°ãƒˆãƒ¬ãƒ³ãƒ‰ã¨æ¥é€±ã®å±•æœ›</span><span class="dl">"</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="na">theme</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ãƒ‡ãƒ¼ã‚¿åˆ†æãƒã‚¹ã‚¿ãƒ¼é€±é–“</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">focus</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ãƒ‡ãƒ¼ã‚¿åˆ†æ</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">dailyTopics</span><span class="p">:</span> <span class="p">[</span>
        <span class="dl">"</span><span class="s2">Googleã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹4Ã—AIã§å£²ä¸Šäºˆæ¸¬ç²¾åº¦90%é”æˆ</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">é¡§å®¢è¡Œå‹•ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰èª­ã¿è§£ãè³¼è²·å¿ƒç†ãƒ‘ã‚¿ãƒ¼ãƒ³</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">A/Bãƒ†ã‚¹ãƒˆã®çµæœã‚’AIã§è‡ªå‹•æœ€é©åŒ–ã™ã‚‹æ–¹æ³•</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">SNSåˆ†æãƒ„ãƒ¼ãƒ«ã§ç«¶åˆã®æˆ¦ç•¥ã‚’ä¸¸è£¸ã«ã™ã‚‹æŠ€è¡“</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">ãƒ‡ãƒ¼ã‚¿ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã§çµŒå–¶é™£ã‚’èª¬å¾—</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">AIÃ—çµ±è¨ˆå­¦ã§å°ãå‡ºã™ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ROIæœ€å¤§åŒ–</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">é€±æœ«ã¾ã¨ã‚ï¼šãƒ‡ãƒ¼ã‚¿ãƒ‰ãƒªãƒ–ãƒ³çµŒå–¶ã®å®Œå…¨ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—</span><span class="dl">"</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">];</span>
  
  <span class="kd">const</span> <span class="nx">selectedTheme</span> <span class="o">=</span> <span class="nx">weeklyThemes</span><span class="p">[</span><span class="nx">weekNumber</span> <span class="o">%</span> <span class="nx">weeklyThemes</span><span class="p">.</span><span class="nx">length</span><span class="p">];</span>
  
  <span class="c1">// é€±æ¬¡ä¼ç”»ã‚’ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ä¿å­˜</span>
  <span class="kd">const</span> <span class="nx">weeklyPlanId</span> <span class="o">=</span> <span class="s2">`weekly_plan_</span><span class="p">${</span><span class="nx">Utilities</span><span class="p">.</span><span class="nx">formatDate</span><span class="p">(</span><span class="nx">startDate</span><span class="p">,</span> <span class="dl">'</span><span class="s1">JST</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">yyyyMMdd</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">;</span>
  <span class="nx">PropertiesService</span><span class="p">.</span><span class="nx">getScriptProperties</span><span class="p">().</span><span class="nx">setProperty</span><span class="p">(</span><span class="nx">weeklyPlanId</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
    <span class="nx">weekNumber</span><span class="p">,</span>
    <span class="na">theme</span><span class="p">:</span> <span class="nx">selectedTheme</span><span class="p">.</span><span class="nx">theme</span><span class="p">,</span>
    <span class="na">focus</span><span class="p">:</span> <span class="nx">selectedTheme</span><span class="p">.</span><span class="nx">focus</span><span class="p">,</span>
    <span class="na">dailyTopics</span><span class="p">:</span> <span class="nx">selectedTheme</span><span class="p">.</span><span class="nx">dailyTopics</span><span class="p">,</span>
    <span class="na">startDate</span><span class="p">:</span> <span class="nx">startDate</span><span class="p">.</span><span class="nx">toISOString</span><span class="p">(),</span>
    <span class="na">status</span><span class="p">:</span> <span class="dl">'</span><span class="s1">active</span><span class="dl">'</span>
  <span class="p">}));</span>
  
  <span class="nx">PropertiesService</span><span class="p">.</span><span class="nx">getScriptProperties</span><span class="p">().</span><span class="nx">setProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">currentWeeklyPlan</span><span class="dl">'</span><span class="p">,</span> <span class="nx">weeklyPlanId</span><span class="p">);</span>
  
  <span class="k">return</span> <span class="nx">selectedTheme</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// ===== ğŸ“… æ¯æ—¥ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç¢ºèªãƒ¡ãƒ¼ãƒ« =====</span>
<span class="kd">function</span> <span class="nx">sendDailyContentConfirmation</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">today</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">dayOfWeek</span> <span class="o">=</span> <span class="nx">today</span><span class="p">.</span><span class="nx">getDay</span><span class="p">();</span> <span class="c1">// 0=æ—¥æ›œæ—¥</span>
  <span class="kd">const</span> <span class="nx">dayNames</span> <span class="o">=</span> <span class="p">[</span><span class="dl">'</span><span class="s1">æ—¥</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">æœˆ</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">ç«</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">æ°´</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">æœ¨</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">é‡‘</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">åœŸ</span><span class="dl">'</span><span class="p">];</span>
  
  <span class="c1">// é€±æ¬¡ãƒ—ãƒ©ãƒ³ã‚’å–å¾—</span>
  <span class="kd">const</span> <span class="nx">currentPlanId</span> <span class="o">=</span> <span class="nx">PropertiesService</span><span class="p">.</span><span class="nx">getScriptProperties</span><span class="p">().</span><span class="nx">getProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">currentWeeklyPlan</span><span class="dl">'</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">currentPlanId</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">createWeeklyContentPlan</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">sendDailyContentConfirmation</span><span class="p">();</span>
  <span class="p">}</span>
  
  <span class="kd">const</span> <span class="nx">weeklyPlan</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">PropertiesService</span><span class="p">.</span><span class="nx">getScriptProperties</span><span class="p">().</span><span class="nx">getProperty</span><span class="p">(</span><span class="nx">currentPlanId</span><span class="p">));</span>
  <span class="kd">const</span> <span class="nx">todaysTopic</span> <span class="o">=</span> <span class="nx">weeklyPlan</span><span class="p">.</span><span class="nx">dailyTopics</span><span class="p">[</span><span class="nx">dayOfWeek</span><span class="p">];</span>
  
  <span class="c1">// Claude AIã§é«˜åº¦ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ææ¡ˆã‚’ç”Ÿæˆ</span>
  <span class="kd">const</span> <span class="nx">aiSuggestion</span> <span class="o">=</span> <span class="nx">generateAdvancedContentSuggestion</span><span class="p">(</span><span class="nx">todaysTopic</span><span class="p">,</span> <span class="nx">weeklyPlan</span><span class="p">.</span><span class="nx">focus</span><span class="p">);</span>
  
  <span class="kd">const</span> <span class="nx">htmlBody</span> <span class="o">=</span> <span class="s2">`
    &lt;div style="font-family: 'Helvetica Neue', Arial, sans-serif; max-width: 700px; margin: 0 auto; background: #f8fafc;"&gt;
      
      &lt;!-- ğŸ¯ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼ --&gt;
      &lt;div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%); padding: 30px; text-align: center; border-radius: 15px 15px 0 0; position: relative; overflow: hidden;"&gt;
        &lt;div style="position: absolute; top: -50px; right: -50px; width: 150px; height: 150px; background: rgba(255,255,255,0.1); border-radius: 50%; opacity: 0.6;"&gt;&lt;/div&gt;
        &lt;div style="position: absolute; bottom: -30px; left: -30px; width: 100px; height: 100px; background: rgba(255,255,255,0.08); border-radius: 50%;"&gt;&lt;/div&gt;
        
        &lt;div style="position: absolute; top: 20px; right: 25px; background: rgba(255,255,255,0.25); padding: 8px 15px; border-radius: 20px; font-size: 12px; color: white; font-weight: 700; backdrop-filter: blur(10px);"&gt;
          ğŸ¤– Premium AI
        &lt;/div&gt;
        
        &lt;h1 style="color: white; margin: 0 0 15px 0; font-size: 28px; font-weight: 800; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);"&gt;
          ğŸ“… </span><span class="p">${</span><span class="nx">Utilities</span><span class="p">.</span><span class="nx">formatDate</span><span class="p">(</span><span class="nx">today</span><span class="p">,</span> <span class="dl">'</span><span class="s1">JST</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">MMæœˆddæ—¥</span><span class="dl">'</span><span class="p">)}</span><span class="s2">ï¼ˆ</span><span class="p">${</span><span class="nx">dayNames</span><span class="p">[</span><span class="nx">dayOfWeek</span><span class="p">]}</span><span class="s2">ï¼‰ã®è¨˜äº‹ç¢ºèª
        &lt;/h1&gt;
        &lt;p style="color: rgba(255,255,255,0.95); margin: 0; font-size: 16px; font-weight: 500;"&gt;
          </span><span class="p">${</span><span class="nx">weeklyPlan</span><span class="p">.</span><span class="nx">theme</span><span class="p">}</span><span class="s2"> - Day </span><span class="p">${</span><span class="nx">dayOfWeek</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span><span class="s2">/7
        &lt;/p&gt;
      &lt;/div&gt;
      
      &lt;!-- ğŸ“‹ ä»Šæ—¥ã®è¨˜äº‹ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ --&gt;
      &lt;div style="background: white; padding: 35px; border-left: 1px solid #e2e8f0; border-right: 1px solid #e2e8f0;"&gt;
        
        &lt;!-- ä»Šæ—¥ã®ã‚¿ã‚¤ãƒˆãƒ« --&gt;
        &lt;div style="background: linear-gradient(135deg, #f8fafc, #ffffff); border: 2px solid #8b5cf6; border-radius: 15px; padding: 25px; margin-bottom: 30px; position: relative;"&gt;
          &lt;div style="position: absolute; top: -12px; left: 25px; background: #8b5cf6; color: white; padding: 6px 18px; border-radius: 20px; font-size: 12px; font-weight: 700;"&gt;
            ğŸ“ ä»Šæ—¥ã®è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«
          &lt;/div&gt;
          &lt;h2 style="margin: 15px 0 0 0; color: #1e293b; font-size: 20px; font-weight: 700; line-height: 1.4;"&gt;
            </span><span class="p">${</span><span class="nx">todaysTopic</span><span class="p">}</span><span class="s2">
          &lt;/h2&gt;
        &lt;/div&gt;
        
        &lt;!-- AIææ¡ˆæ§‹æˆ --&gt;
        &lt;div style="background: #fef7ff; border: 2px solid #d8b4fe; border-radius: 12px; padding: 25px; margin-bottom: 25px;"&gt;
          &lt;h3 style="margin: 0 0 20px 0; color: #7c3aed; font-size: 18px; display: flex; align-items: center;"&gt;
            ğŸ§  AIæœ€é©åŒ–æ§‹æˆææ¡ˆ
            &lt;span style="background: #7c3aed; color: white; font-size: 10px; padding: 3px 8px; border-radius: 10px; margin-left: 10px;"&gt;PREMIUM&lt;/span&gt;
          &lt;/h3&gt;
          
          </span><span class="p">${</span><span class="nx">aiSuggestion</span><span class="p">.</span><span class="nx">outline</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">section</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">`
            &lt;div style="margin-bottom: 15px; padding-left: 20px; border-left: 3px solid #d8b4fe;"&gt;
              &lt;div style="font-weight: 600; color: #6b46c1; font-size: 15px;"&gt;</span><span class="p">${</span><span class="nx">section</span><span class="p">.</span><span class="nx">heading</span><span class="p">}</span><span class="s2">&lt;/div&gt;
              &lt;div style="color: #7c2d12; font-size: 13px; margin-top: 5px;"&gt;</span><span class="p">${</span><span class="nx">section</span><span class="p">.</span><span class="nx">description</span><span class="p">}</span><span class="s2">&lt;/div&gt;
              </span><span class="p">${</span><span class="nx">index</span> <span class="o">===</span> <span class="mi">1</span> <span class="p">?</span> <span class="dl">'</span><span class="s1">&lt;div style="color: #059669; font-size: 11px; font-weight: 600; margin-top: 5px;"&gt;ğŸ“¸ ã“ã“ã«æœ€é©åŒ–ç”»åƒã‚’è‡ªå‹•é…ç½®&lt;/div&gt;</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">''</span><span class="p">}</span><span class="s2">
            &lt;/div&gt;
          `</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="dl">''</span><span class="p">)}</span><span class="s2">
        &lt;/div&gt;
        
        &lt;!-- ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒ»SEOæƒ…å ± --&gt;
        &lt;div style="background: #f0f9ff; border: 1px solid #7dd3fc; border-radius: 10px; padding: 20px; margin-bottom: 25px;"&gt;
          &lt;h4 style="margin: 0 0 15px 0; color: #0c4a6e; font-size: 16px;"&gt;ğŸ” SEOæœ€é©åŒ–æƒ…å ±&lt;/h4&gt;
          &lt;div style="display: flex; gap: 15px; flex-wrap: wrap; font-size: 12px;"&gt;
            &lt;div&gt;
              &lt;strong style="color: #0369a1;"&gt;ãƒ¡ã‚¤ãƒ³ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰:&lt;/strong&gt;
              &lt;span style="color: #075985;"&gt;</span><span class="p">${</span><span class="nx">aiSuggestion</span><span class="p">.</span><span class="nx">mainKeyword</span><span class="p">}</span><span class="s2">&lt;/span&gt;
            &lt;/div&gt;
            &lt;div&gt;
              &lt;strong style="color: #0369a1;"&gt;æ¤œç´¢ãƒœãƒªãƒ¥ãƒ¼ãƒ :&lt;/strong&gt;
              &lt;span style="color: #075985;"&gt;</span><span class="p">${</span><span class="nx">aiSuggestion</span><span class="p">.</span><span class="nx">searchVolume</span><span class="p">}</span><span class="s2">&lt;/span&gt;
            &lt;/div&gt;
            &lt;div&gt;
              &lt;strong style="color: #0369a1;"&gt;ç«¶åˆé›£æ˜“åº¦:&lt;/strong&gt;
              &lt;span style="color: #075985;"&gt;</span><span class="p">${</span><span class="nx">aiSuggestion</span><span class="p">.</span><span class="nx">difficulty</span><span class="p">}</span><span class="s2">/10&lt;/span&gt;
            &lt;/div&gt;
          &lt;/div&gt;
          
          &lt;div style="margin-top: 12px;"&gt;
            &lt;strong style="color: #0369a1; font-size: 12px;"&gt;é–¢é€£ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰:&lt;/strong&gt;
            &lt;div style="display: flex; gap: 8px; margin-top: 5px; flex-wrap: wrap;"&gt;
              </span><span class="p">${</span><span class="nx">aiSuggestion</span><span class="p">.</span><span class="nx">relatedKeywords</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">keyword</span> <span class="o">=&gt;</span> <span class="s2">`
                &lt;span style="background: #e0f2fe; color: #0c4a6e; padding: 3px 8px; border-radius: 12px; font-size: 10px; font-weight: 500;"&gt;</span><span class="p">${</span><span class="nx">keyword</span><span class="p">}</span><span class="s2">&lt;/span&gt;
              `</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="dl">''</span><span class="p">)}</span><span class="s2">
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        
        &lt;!-- ç°¡å˜æ“ä½œã‚¬ã‚¤ãƒ‰ --&gt;
        &lt;div style="background: linear-gradient(135deg, #dcfce7, #f0fdf4); border: 2px solid #16a34a; border-radius: 12px; padding: 20px;"&gt;
          &lt;h3 style="margin: 0 0 15px 0; color: #15803d; font-size: 16px;"&gt;ğŸ“§ ç°¡å˜æ“ä½œï¼ˆã“ã®ãƒ¡ãƒ¼ãƒ«ã«è¿”ä¿¡ï¼‰&lt;/h3&gt;
          
          &lt;div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;"&gt;
            &lt;div style="background: white; padding: 15px; border-radius: 8px; text-align: center;"&gt;
              &lt;div style="color: #16a34a; font-weight: 700; font-size: 16px;"&gt;"OK" ã¾ãŸã¯ "1"&lt;/div&gt;
              &lt;div style="color: #166534; font-size: 12px;"&gt;ãã®ã¾ã¾æŠ•ç¨¿&lt;/div&gt;
            &lt;/div&gt;
            &lt;div style="background: white; padding: 15px; border-radius: 8px; text-align: center;"&gt;
              &lt;div style="color: #dc2626; font-weight: 700; font-size: 16px;"&gt;"SKIP" ã¾ãŸã¯ "0"&lt;/div&gt;
              &lt;div style="color: #991b1b; font-size: 12px;"&gt;ä»Šæ—¥ã¯ã‚¹ã‚­ãƒƒãƒ—&lt;/div&gt;
            &lt;/div&gt;
          &lt;/div&gt;
          
          &lt;div style="background: white; padding: 15px; border-radius: 8px;"&gt;
            &lt;div style="color: #7c3aed; font-weight: 700; margin-bottom: 8px;"&gt;ğŸ› ï¸ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºä¾‹:&lt;/div&gt;
            &lt;div style="font-size: 12px; color: #4c1d95; line-height: 1.6;"&gt;
              â€¢ "OK ãƒ‡ãƒ¼ã‚¿é‡è¦–ã§" â†’ ãƒ‡ãƒ¼ã‚¿ãƒ»çµ±è¨ˆã‚’å¤šã‚ã«&lt;br&gt;
              â€¢ "OK äº‹ä¾‹å¤šã‚ã§" â†’ å®Ÿä¾‹ãƒ»ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£ä¸­å¿ƒ&lt;br&gt;
              â€¢ "OK åˆå¿ƒè€…å‘ã‘ã§" â†’ åŸºæœ¬èª¬æ˜ã‚’å……å®Ÿ&lt;br&gt;
              â€¢ "OK ç¾å®¹æ¥­ç•Œç‰¹åŒ–ã§" â†’ ç¾å®¹æ¥­ç•Œã®äº‹ä¾‹ã«ç‰¹åŒ–
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      
      &lt;!-- ğŸ¤– ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ•ãƒƒã‚¿ãƒ¼ --&gt;
      &lt;div style="background: linear-gradient(135deg, #1e293b 0%, #334155 50%, #0f172a 100%); padding: 25px; text-align: center; border-radius: 0 0 15px 15px;"&gt;
        &lt;div style="color: #e2e8f0; font-size: 14px; font-weight: 600; margin-bottom: 8px;"&gt;
          ğŸ¤– LeadFive Premium AI Blog System
        &lt;/div&gt;
        &lt;div style="color: #94a3b8; font-size: 11px; margin-bottom: 15px;"&gt;
          è¿”ä¿¡å¾Œ15-20åˆ†ã§é«˜å“è³ªè¨˜äº‹ãŒè‡ªå‹•æŠ•ç¨¿ã•ã‚Œã¾ã™
        &lt;/div&gt;
        
        &lt;!-- ä»Šé€±ã®é€²æ— --&gt;
        &lt;div style="background: rgba(139, 92, 246, 0.1); padding: 12px; border-radius: 8px; margin-top: 15px;"&gt;
          &lt;div style="color: #c4b5fd; font-size: 11px; margin-bottom: 5px;"&gt;ğŸ“Š ä»Šé€±ã®é€²æ—&lt;/div&gt;
          &lt;div style="display: flex; justify-content: center; gap: 3px;"&gt;
            </span><span class="p">${</span><span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">({</span><span class="na">length</span><span class="p">:</span> <span class="mi">7</span><span class="p">},</span> <span class="p">(</span><span class="nx">_</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="s2">`
              &lt;div style="width: 20px; height: 6px; background: </span><span class="p">${</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">dayOfWeek</span> <span class="p">?</span> <span class="dl">'</span><span class="s1">#8b5cf6</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">rgba(139, 92, 246, 0.3)</span><span class="dl">'</span><span class="p">}</span><span class="s2">; border-radius: 3px;"&gt;&lt;/div&gt;
            `</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="dl">''</span><span class="p">)}</span><span class="s2">
          &lt;/div&gt;
          &lt;div style="color: #a78bfa; font-size: 10px; margin-top: 5px;"&gt;
            </span><span class="p">${</span><span class="nx">dayOfWeek</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span><span class="s2">/7 - </span><span class="p">${</span><span class="nx">weeklyPlan</span><span class="p">.</span><span class="nx">theme</span><span class="p">}</span><span class="s2">
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  `</span><span class="p">;</span>
  
  <span class="k">try</span> <span class="p">{</span>
    <span class="nx">MailApp</span><span class="p">.</span><span class="nx">sendEmail</span><span class="p">({</span>
      <span class="na">to</span><span class="p">:</span> <span class="nx">CONFIG</span><span class="p">.</span><span class="nx">recipientEmail</span><span class="p">,</span>
      <span class="na">subject</span><span class="p">:</span> <span class="s2">`ğŸ“…ã€LeadFive Premiumã€‘</span><span class="p">${</span><span class="nx">Utilities</span><span class="p">.</span><span class="nx">formatDate</span><span class="p">(</span><span class="nx">today</span><span class="p">,</span> <span class="dl">'</span><span class="s1">JST</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">MMæœˆddæ—¥</span><span class="dl">'</span><span class="p">)}</span><span class="s2">ã®è¨˜äº‹ç¢ºèª - </span><span class="p">${</span><span class="nx">todaysTopic</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)}</span><span class="s2">...`</span><span class="p">,</span>
      <span class="na">htmlBody</span><span class="p">:</span> <span class="nx">htmlBody</span><span class="p">,</span>
      <span class="na">name</span><span class="p">:</span> <span class="nx">CONFIG</span><span class="p">.</span><span class="nx">botName</span>
    <span class="p">});</span>
    
    <span class="c1">// ä»Šæ—¥ã®ææ¡ˆã‚’ä¿å­˜</span>
    <span class="kd">const</span> <span class="nx">dailyProposalId</span> <span class="o">=</span> <span class="s2">`daily_</span><span class="p">${</span><span class="nx">Utilities</span><span class="p">.</span><span class="nx">formatDate</span><span class="p">(</span><span class="nx">today</span><span class="p">,</span> <span class="dl">'</span><span class="s1">JST</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">yyyyMMdd</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">;</span>
    <span class="nx">PropertiesService</span><span class="p">.</span><span class="nx">getScriptProperties</span><span class="p">().</span><span class="nx">setProperty</span><span class="p">(</span><span class="nx">dailyProposalId</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
      <span class="na">topic</span><span class="p">:</span> <span class="nx">todaysTopic</span><span class="p">,</span>
      <span class="nx">aiSuggestion</span><span class="p">,</span>
      <span class="na">weeklyTheme</span><span class="p">:</span> <span class="nx">weeklyPlan</span><span class="p">.</span><span class="nx">theme</span><span class="p">,</span>
      <span class="nx">dayOfWeek</span><span class="p">,</span>
      <span class="na">timestamp</span><span class="p">:</span> <span class="nx">today</span><span class="p">.</span><span class="nx">toISOString</span><span class="p">()</span>
    <span class="p">}));</span>
    
    <span class="nx">PropertiesService</span><span class="p">.</span><span class="nx">getScriptProperties</span><span class="p">().</span><span class="nx">setProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">latestDailyProposal</span><span class="dl">'</span><span class="p">,</span> <span class="nx">dailyProposalId</span><span class="p">);</span>
    
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">âœ… æ¯æ—¥ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç¢ºèªãƒ¡ãƒ¼ãƒ«é€ä¿¡å®Œäº†</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">âŒ æ¯æ—¥ç¢ºèªãƒ¡ãƒ¼ãƒ«é€ä¿¡ã‚¨ãƒ©ãƒ¼:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ===== ğŸ§  é«˜åº¦AIææ¡ˆç”Ÿæˆ =====</span>
<span class="kd">function</span> <span class="nx">generateAdvancedContentSuggestion</span><span class="p">(</span><span class="nx">topic</span><span class="p">,</span> <span class="nx">focus</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ãƒªã‚¢ãƒ«ãªAIåˆ†æã‚’æ¨¡æ“¬ï¼ˆå®Ÿéš›ã«ã¯Claude APIä½¿ç”¨ï¼‰</span>
  <span class="kd">const</span> <span class="nx">suggestions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">ChatGPT-4ã§ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°æˆ¦ç•¥ã‚’é©æ–°ã™ã‚‹5ã¤ã®æ–¹æ³•</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">mainKeyword</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ChatGPT ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">searchVolume</span><span class="p">:</span> <span class="dl">"</span><span class="s2">15,400/æœˆ</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">difficulty</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
      <span class="na">relatedKeywords</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">AIæ´»ç”¨</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°è‡ªå‹•åŒ–</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">ãƒ‡ã‚¸ã‚¿ãƒ«æˆ¦ç•¥</span><span class="dl">"</span><span class="p">],</span>
      <span class="na">outline</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="na">heading</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ğŸ¯ ãªãœä»Šã€ChatGPTãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ãªã®ã‹</span><span class="dl">"</span><span class="p">,</span>
          <span class="na">description</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ç¾çŠ¶ã®å•é¡Œç‚¹ã¨æ©Ÿä¼šã®æç¤ºã§èª­è€…ã®é–¢å¿ƒã‚’å¼•ãã¤ã‘ã‚‹</span><span class="dl">"</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="na">heading</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ğŸ’¡ 5ã¤ã®é©æ–°çš„æ´»ç”¨æ–¹æ³•ï¼ˆè©³ç´°è§£èª¬ï¼‰</span><span class="dl">"</span><span class="p">,</span>
          <span class="na">description</span><span class="p">:</span> <span class="dl">"</span><span class="s2">å…·ä½“çš„æ‰‹æ³•ã‚’æ®µéšçš„ã«èª¬æ˜ã€å®Ÿè·µã—ã‚„ã™ã„å½¢ã§æç¤º</span><span class="dl">"</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="na">heading</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ğŸ“Š å®Ÿéš›ã®æˆåŠŸäº‹ä¾‹ã¨æ•°å€¤ãƒ‡ãƒ¼ã‚¿</span><span class="dl">"</span><span class="p">,</span>
          <span class="na">description</span><span class="p">:</span> <span class="dl">"</span><span class="s2">LeadFiveã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®å®Ÿç¸¾ã‚’å…ƒã«ã—ãŸèª¬å¾—åŠ›ã®ã‚ã‚‹äº‹ä¾‹</span><span class="dl">"</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="na">heading</span><span class="p">:</span> <span class="dl">"</span><span class="s2">âš ï¸ ã‚ˆãã‚ã‚‹å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å›é¿æ³•</span><span class="dl">"</span><span class="p">,</span>
          <span class="na">description</span><span class="p">:</span> <span class="dl">"</span><span class="s2">èª­è€…ãŒé™¥ã‚ŠãŒã¡ãªç½ ã‚’äº‹å‰ã«è­¦å‘Šã€ä¿¡é ¼æ€§ã‚’é«˜ã‚ã‚‹</span><span class="dl">"</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="na">heading</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ğŸš€ ä»Šã™ãå§‹ã‚ã‚‰ã‚Œã‚‹å®Ÿè·µã‚¹ãƒ†ãƒƒãƒ—</span><span class="dl">"</span><span class="p">,</span>
          <span class="na">description</span><span class="p">:</span> <span class="dl">"</span><span class="s2">è¡Œå‹•ã‚’ä¿ƒã™CTAã¨å…·ä½“çš„ãªæ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</span><span class="dl">"</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">};</span>
  
  <span class="k">return</span> <span class="nx">suggestions</span><span class="p">[</span><span class="nx">topic</span><span class="p">]</span> <span class="o">||</span> <span class="p">{</span>
    <span class="na">mainKeyword</span><span class="p">:</span> <span class="nx">focus</span><span class="p">,</span>
    <span class="na">searchVolume</span><span class="p">:</span> <span class="dl">"</span><span class="s2">8,200/æœˆ</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">difficulty</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
    <span class="na">relatedKeywords</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">AIæ´»ç”¨</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">ãƒ‡ã‚¸ã‚¿ãƒ«ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">è‡ªå‹•åŒ–</span><span class="dl">"</span><span class="p">],</span>
    <span class="na">outline</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="na">heading</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ğŸ¯ å•é¡Œæèµ·ï¼šç¾åœ¨ã®èª²é¡Œ</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">description</span><span class="p">:</span> <span class="dl">"</span><span class="s2">èª­è€…ã®æŠ±ãˆã‚‹å•é¡Œã‚’æ˜ç¢ºåŒ–</span><span class="dl">"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">heading</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ğŸ’¡ è§£æ±ºç­–ã®æç¤º</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">description</span><span class="p">:</span> <span class="dl">"</span><span class="s2">å…·ä½“çš„ãªè§£æ±ºæ–¹æ³•ã‚’æ®µéšçš„ã«èª¬æ˜</span><span class="dl">"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">heading</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ğŸ“ˆ åŠ¹æœã¨å®Ÿä¾‹</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">description</span><span class="p">:</span> <span class="dl">"</span><span class="s2">å®Ÿéš›ã®æˆæœäº‹ä¾‹ã¨ãƒ‡ãƒ¼ã‚¿</span><span class="dl">"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">heading</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ğŸš€ å®Ÿè·µæ–¹æ³•</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">description</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ä»Šã™ãã§ãã‚‹è¡Œå‹•è¨ˆç”»</span><span class="dl">"</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">};</span>
<span class="p">}</span>

<span class="c1">// ===== ğŸ“§ è¿”ä¿¡å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ ï¼ˆé«˜åº¦ç‰ˆï¼‰ =====</span>
<span class="kd">function</span> <span class="nx">processDailyConfirmationReplies</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">threads</span> <span class="o">=</span> <span class="nx">GmailApp</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span>
      <span class="s2">`to:</span><span class="p">${</span><span class="nx">CONFIG</span><span class="p">.</span><span class="nx">recipientEmail</span><span class="p">}</span><span class="s2"> subject:"è¨˜äº‹ç¢ºèª" is:unread newer_than:1d`</span><span class="p">,</span>
      <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span>
    <span class="p">);</span>
    
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`ğŸ“¬ ç¢ºèªãƒ¡ãƒ¼ãƒ«è¿”ä¿¡æ¤œç´¢çµæœ: </span><span class="p">${</span><span class="nx">threads</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span><span class="s2">ä»¶`</span><span class="p">);</span>
    
    <span class="nx">threads</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">thread</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">messages</span> <span class="o">=</span> <span class="nx">thread</span><span class="p">.</span><span class="nx">getMessages</span><span class="p">();</span>
      
      <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">messages</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">message</span> <span class="o">=</span> <span class="nx">messages</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="kd">const</span> <span class="k">from</span> <span class="o">=</span> <span class="nx">message</span><span class="p">.</span><span class="nx">getFrom</span><span class="p">();</span>
        <span class="kd">const</span> <span class="nx">isUnread</span> <span class="o">=</span> <span class="nx">message</span><span class="p">.</span><span class="nx">isUnread</span><span class="p">();</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="k">from</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">CONFIG</span><span class="p">.</span><span class="nx">recipientEmail</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">isUnread</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">bodyText</span> <span class="o">=</span> <span class="nx">message</span><span class="p">.</span><span class="nx">getPlainBody</span><span class="p">();</span>
          <span class="kd">const</span> <span class="nx">replyContent</span> <span class="o">=</span> <span class="nx">bodyText</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="se">\\</span><span class="s1">n</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">trim</span><span class="p">().</span><span class="nx">toUpperCase</span><span class="p">();</span>
          
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`ğŸ” è¿”ä¿¡å†…å®¹: "</span><span class="p">${</span><span class="nx">replyContent</span><span class="p">}</span><span class="s2">"`</span><span class="p">);</span>
          
          <span class="c1">// è¿”ä¿¡ãƒ‘ã‚¿ãƒ¼ãƒ³è§£æ</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">replyContent</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">OK</span><span class="dl">'</span><span class="p">)</span> <span class="o">||</span> <span class="nx">replyContent</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">customInstruction</span> <span class="o">=</span> <span class="nx">extractCustomInstruction</span><span class="p">(</span><span class="nx">bodyText</span><span class="p">);</span>
            <span class="nx">createPremiumBlogPost</span><span class="p">(</span><span class="nx">customInstruction</span><span class="p">);</span>
            <span class="nx">message</span><span class="p">.</span><span class="nx">markRead</span><span class="p">();</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">âœ… è¨˜äº‹ä½œæˆé–‹å§‹</span><span class="dl">'</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">replyContent</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">SKIP</span><span class="dl">'</span><span class="p">)</span> <span class="o">||</span> <span class="nx">replyContent</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">0</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">sendSkipConfirmation</span><span class="p">();</span>
            <span class="nx">message</span><span class="p">.</span><span class="nx">markRead</span><span class="p">();</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">â­ï¸ ä»Šæ—¥ã¯ã‚¹ã‚­ãƒƒãƒ—</span><span class="dl">'</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">âŒ è¿”ä¿¡å‡¦ç†ã‚¨ãƒ©ãƒ¼:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ===== âœ¨ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ è¨˜äº‹ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ  =====</span>
<span class="kd">function</span> <span class="nx">createPremiumBlogPost</span><span class="p">(</span><span class="nx">customInstruction</span> <span class="o">=</span> <span class="dl">''</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="c1">// ä»Šæ—¥ã®ææ¡ˆã‚’å–å¾—</span>
    <span class="kd">const</span> <span class="nx">latestProposalId</span> <span class="o">=</span> <span class="nx">PropertiesService</span><span class="p">.</span><span class="nx">getScriptProperties</span><span class="p">().</span><span class="nx">getProperty</span><span class="p">(</span><span class="dl">'</span><span class="s1">latestDailyProposal</span><span class="dl">'</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">dailyProposal</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">PropertiesService</span><span class="p">.</span><span class="nx">getScriptProperties</span><span class="p">().</span><span class="nx">getProperty</span><span class="p">(</span><span class="nx">latestProposalId</span><span class="p">));</span>
    
    <span class="c1">// Claude AIã§å®Œå…¨ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆ</span>
    <span class="kd">const</span> <span class="nx">uniqueContent</span> <span class="o">=</span> <span class="nx">generateUniqueContentWithClaude</span><span class="p">(</span><span class="nx">dailyProposal</span><span class="p">,</span> <span class="nx">customInstruction</span><span class="p">);</span>
    
    <span class="c1">// æœ€é©åŒ–ç”»åƒã‚’é¸æŠ</span>
    <span class="kd">const</span> <span class="nx">optimizedImage</span> <span class="o">=</span> <span class="nx">selectOptimalImageFromUnsplash</span><span class="p">(</span><span class="nx">dailyProposal</span><span class="p">.</span><span class="nx">topic</span><span class="p">);</span>
    
    <span class="c1">// å†…éƒ¨ãƒªãƒ³ã‚¯æœ€é©åŒ–</span>
    <span class="kd">const</span> <span class="nx">contentWithLinks</span> <span class="o">=</span> <span class="nx">optimizeInternalLinks</span><span class="p">(</span><span class="nx">uniqueContent</span><span class="p">,</span> <span class="nx">dailyProposal</span><span class="p">.</span><span class="nx">topic</span><span class="p">);</span>
    
    <span class="c1">// éå»è¨˜äº‹æ›´æ–°ï¼ˆåŒæ–¹å‘ãƒªãƒ³ã‚¯ï¼‰</span>
    <span class="nx">updatePastArticlesWithNewLinks</span><span class="p">(</span><span class="nx">dailyProposal</span><span class="p">.</span><span class="nx">topic</span><span class="p">);</span>
    
    <span class="c1">// GitHub Actions ãƒˆãƒªã‚¬ãƒ¼</span>
    <span class="kd">const</span> <span class="nx">success</span> <span class="o">=</span> <span class="nx">triggerGitHubActionsWithPremiumData</span><span class="p">({</span>
      <span class="na">content</span><span class="p">:</span> <span class="nx">contentWithLinks</span><span class="p">,</span>
      <span class="na">image</span><span class="p">:</span> <span class="nx">optimizedImage</span><span class="p">,</span>
      <span class="na">proposal</span><span class="p">:</span> <span class="nx">dailyProposal</span><span class="p">,</span>
      <span class="nx">customInstruction</span>
    <span class="p">});</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">sendPremiumCompletionEmail</span><span class="p">(</span><span class="nx">dailyProposal</span><span class="p">,</span> <span class="nx">customInstruction</span><span class="p">);</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">âŒ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ è¨˜äº‹ç”Ÿæˆã‚¨ãƒ©ãƒ¼:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ===== ğŸ§  Claude AI ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ =====</span>
<span class="kd">function</span> <span class="nx">generateUniqueContentWithClaude</span><span class="p">(</span><span class="nx">dailyProposal</span><span class="p">,</span> <span class="nx">customInstruction</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// å®Ÿéš›ã®Claude APIçµ±åˆæ™‚ã¯ã“ã“ã‚’ç½®ãæ›ãˆ</span>
  <span class="kd">const</span> <span class="nx">today</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">dateStr</span> <span class="o">=</span> <span class="nx">Utilities</span><span class="p">.</span><span class="nx">formatDate</span><span class="p">(</span><span class="nx">today</span><span class="p">,</span> <span class="dl">'</span><span class="s1">JST</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">yyyy-MM-dd</span><span class="dl">'</span><span class="p">);</span>
  
  <span class="kd">const</span> <span class="nx">focusArea</span> <span class="o">=</span> <span class="nx">analyzeFocusArea</span><span class="p">(</span><span class="nx">customInstruction</span><span class="p">);</span>
  
  <span class="kd">const</span> <span class="nx">content</span> <span class="o">=</span> <span class="s2">`---
layout: blog-post
title: "</span><span class="p">${</span><span class="nx">dailyProposal</span><span class="p">.</span><span class="nx">topic</span><span class="p">}</span><span class="s2">"
date: </span><span class="p">${</span><span class="nx">dateStr</span><span class="p">}</span><span class="s2">
categories: [</span><span class="p">${</span><span class="nx">dailyProposal</span><span class="p">.</span><span class="nx">aiSuggestion</span><span class="p">.</span><span class="nx">mainKeyword</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">||</span> <span class="dl">'</span><span class="s1">AIãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°</span><span class="dl">'</span><span class="p">}</span><span class="s2">]
tags: [</span><span class="p">${</span><span class="nx">dailyProposal</span><span class="p">.</span><span class="nx">aiSuggestion</span><span class="p">.</span><span class="nx">relatedKeywords</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="dl">'</span><span class="s1">, </span><span class="dl">'</span><span class="p">)}</span><span class="s2">]
author: "LeadFive AI"
description: "</span><span class="p">${</span><span class="nx">dailyProposal</span><span class="p">.</span><span class="nx">topic</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)}</span><span class="s2">ã«ã¤ã„ã¦ã€LeadFiveç‹¬è‡ªã®8ã¤ã®æœ¬èƒ½ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°æ‰‹æ³•ã§å¾¹åº•è§£èª¬ã—ã¾ã™ã€‚"
image: "https://images.unsplash.com/photo-1551434678-e076c223a692?w=1200&amp;h=630&amp;fit=crop"
---

# </span><span class="p">${</span><span class="nx">dailyProposal</span><span class="p">.</span><span class="nx">topic</span><span class="p">}</span><span class="s2">

## ğŸ¯ ã“ã®è¨˜äº‹ã§å¾—ã‚‰ã‚Œã‚‹ã“ã¨

</span><span class="p">${</span><span class="nx">dailyProposal</span><span class="p">.</span><span class="nx">topic</span><span class="p">}</span><span class="s2">ã«ã¤ã„ã¦ã€LeadFiveç‹¬è‡ªã®å¿ƒç†å­¦ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’ç”¨ã„ãŸå®Ÿè·µçš„ãªæ‰‹æ³•ã‚’å­¦ã¹ã¾ã™ã€‚èª­äº†å¾Œã«ã¯å…·ä½“çš„ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ã‚’æŒã£ã¦å®Ÿè·µã‚’é–‹å§‹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

</span><span class="p">${</span><span class="nx">focusArea</span> <span class="p">?</span> <span class="s2">`**ç‰¹åˆ¥ãƒ•ã‚©ãƒ¼ã‚«ã‚¹**: </span><span class="p">${</span><span class="nx">focusArea</span><span class="p">}</span><span class="s2">`</span> <span class="p">:</span> <span class="dl">''</span><span class="p">}</span><span class="s2">

## ğŸ“Š ãªãœä»Šã€ã“ã®å–ã‚Šçµ„ã¿ãŒé‡è¦ãªã®ã‹

ç¾åœ¨ã®å¸‚å ´ç’°å¢ƒã§ã¯ã€</span><span class="p">${</span><span class="nx">dailyProposal</span><span class="p">.</span><span class="nx">aiSuggestion</span><span class="p">.</span><span class="nx">mainKeyword</span><span class="p">}</span><span class="s2">ã«ãŠã‘ã‚‹ç«¶äº‰ãŒæ¿€åŒ–ã—ã¦ã„ã¾ã™ã€‚ã—ã‹ã—ã€å¤šãã®ä¼æ¥­ãŒè¡¨é¢çš„ãªå¯¾å¿œã«ç•™ã¾ã‚Šã€é¡§å®¢ã®æ·±å±¤å¿ƒç†ã‚’ç†è§£ã—ãŸæˆ¦ç•¥çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’å®Ÿè·µã§ãã¦ã„ãªã„ã®ãŒç¾çŠ¶ã§ã™ã€‚

## ğŸ’¡ LeadFiveç‹¬è‡ªã®8ã¤ã®æœ¬èƒ½ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

### 1. ç”Ÿå­˜æœ¬èƒ½ - ãƒªã‚¹ã‚¯å›é¿ã®å¿ƒç†
é¡§å®¢ãŒæœ€ã‚‚æã‚Œã‚‹ãƒªã‚¹ã‚¯ã‚’ç‰¹å®šã—ã€ãã‚Œã‚’è§£æ±ºã™ã‚‹ææ¡ˆã‚’ã™ã‚‹ã“ã¨ã§æ·±ã„ä¿¡é ¼é–¢ä¿‚ã‚’ç¯‰ãã¾ã™ã€‚

### 2. ç«¶äº‰æœ¬èƒ½ - ä»–ç¤¾ã¨ã®å·®åˆ¥åŒ–
ç«¶åˆä»–ç¤¾ãŒã¾ã æ°—ã¥ã„ã¦ã„ãªã„å„ªä½æ€§ã‚’ç™ºè¦‹ã—ã€åœ§å€’çš„ãªãƒã‚¸ã‚·ãƒ§ãƒ³ã‚’ç¢ºç«‹ã—ã¾ã™ã€‚

### 3. å¥½å¥‡å¿ƒ - æ–°ã—ã„å¯èƒ½æ€§ã¸ã®èˆˆå‘³
é©æ–°çš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’ç¤ºã™ã“ã¨ã§ã€é¡§å®¢ã®çŸ¥çš„å¥½å¥‡å¿ƒã‚’åˆºæ¿€ã—ã€é–¢å¿ƒã‚’å¼•ãã¤ã‘ã¾ã™ã€‚

### 4. ç¤¾ä¼šçš„æ‰¿èª - ä»–è€…ã‹ã‚‰ã®è©•ä¾¡
æˆåŠŸäº‹ä¾‹ã¨ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ—ãƒ«ãƒ¼ãƒ•ã‚’æ´»ç”¨ã—ã€ä¿¡é ¼æ€§ã‚’é«˜ã‚ã¾ã™ã€‚

### 5. å¿«æ¥½è¿½æ±‚ - æº€è¶³æ„Ÿãƒ»é”æˆæ„Ÿ
å³åº§ã«åŠ¹æœã‚’å®Ÿæ„Ÿã§ãã‚‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ã€é¡§å®¢ã®æº€è¶³åº¦ã‚’æœ€å¤§åŒ–ã—ã¾ã™ã€‚

### 6. å¸°å±æ¬²æ±‚ - ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¸ã®æ‰€å±
åŒã˜ä¾¡å€¤è¦³ã‚’æŒã¤ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®å½¢æˆã§ã€é•·æœŸçš„ãªé–¢ä¿‚ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚

### 7. æ”¯é…æ¬²æ±‚ - ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«æ„Ÿ
é¡§å®¢ãŒè‡ªèº«ã§ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã§ãã‚‹è¦ç´ ã‚’æä¾›ã—ã€ä¸»ä½“æ€§ã‚’ä¿ƒé€²ã—ã¾ã™ã€‚

### 8. è‡ªå·±å®Ÿç¾ - æˆé•·ãƒ»å‘ä¸Šã¸ã®æ¬²æ±‚
é¡§å®¢ã®æˆé•·ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’æ˜ç¢ºåŒ–ã—ã€ç›®æ¨™é”æˆã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚

## ğŸš€ å®Ÿè·µçš„ãªå®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—

### ã‚¹ãƒ†ãƒƒãƒ—1: ç¾çŠ¶åˆ†æ
ã¾ãšã€ã‚ãªãŸã®ç¾åœ¨ã®ãƒã‚¸ã‚·ãƒ§ãƒ³ã¨èª²é¡Œã‚’æ˜ç¢ºã«ã—ã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ—2: æˆ¦ç•¥ç«‹æ¡ˆ
8ã¤ã®æœ¬èƒ½ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’æ´»ç”¨ã—ãŸæˆ¦ç•¥ã‚’ç«‹æ¡ˆã—ã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ—3: å®Ÿè£…é–‹å§‹
å°ã•ãå§‹ã‚ã¦ã€åŠ¹æœã‚’ç¢ºèªã—ãªãŒã‚‰ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ãƒƒãƒ—ã—ã¦ã„ãã¾ã™ã€‚

## ğŸ“ˆ æœŸå¾…ã§ãã‚‹åŠ¹æœ

ã“ã®æ‰‹æ³•ã‚’å®Ÿè·µã™ã‚‹ã“ã¨ã§ä»¥ä¸‹ã®ã‚ˆã†ãªåŠ¹æœãŒæœŸå¾…ã§ãã¾ã™ï¼š

- **å£²ä¸Šå‘ä¸Š**: å¹³å‡20-50%ã®æ”¹å–„
- **åŠ¹ç‡åŒ–**: ä½œæ¥­æ™‚é–“30-40%çŸ­ç¸®
- **é¡§å®¢æº€è¶³åº¦**: ãƒªãƒ”ãƒ¼ãƒˆç‡15-25%å‘ä¸Š

## âš ï¸ ã‚ˆãã‚ã‚‹å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å¯¾ç­–

### å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³1: è¡¨é¢çš„ãªå°å…¥
å¤šãã®ä¼æ¥­ãŒçŠ¯ã™æœ€å¤§ã®é–“é•ã„ã¯ã€æ‰‹æ³•ã‚’è¡¨é¢çš„ã«ã—ã‹ç†è§£ã›ãšã«å°å…¥ã™ã‚‹ã“ã¨ã§ã™ã€‚

**å¯¾ç­–**: æ ¹æœ¬çš„ãªä»•çµ„ã¿ã‚’ç†è§£ã—ã¦ã‹ã‚‰æ®µéšçš„ã«å°å…¥ã™ã‚‹

### å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³2: çŸ­æœŸçš„ãªè¦–ç‚¹
ã™ãã«çµæœã‚’æ±‚ã‚ã™ãã¦ã€ç¶™ç¶šæ€§ã‚’è»½è¦–ã—ã¦ã—ã¾ã†ã‚±ãƒ¼ã‚¹ã§ã™ã€‚

**å¯¾ç­–**: ä¸­é•·æœŸçš„ãªè¦–ç‚¹ã§å–ã‚Šçµ„ã¿ã€å°ã•ãªæ”¹å–„ã‚’ç©ã¿é‡ã­ã‚‹

## ğŸ¯ ä»Šã™ãå®Ÿè·µã§ãã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³

1. **æ­£ã—ã„ç†è§£**: è¡¨é¢çš„ã§ãªãã€æœ¬è³ªã‚’ç†è§£ã™ã‚‹
2. **æ®µéšçš„å®Ÿè£…**: å°ã•ãå§‹ã‚ã¦ç€å®Ÿã«æ‹¡å¤§
3. **ç¶™ç¶šçš„æ”¹å–„**: ãƒ‡ãƒ¼ã‚¿ã‚’åŸºã«å¸¸ã«æœ€é©åŒ–

## ã¾ã¨ã‚ï¼š</span><span class="p">${</span><span class="nx">dailyProposal</span><span class="p">.</span><span class="nx">topic</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/</span><span class="se">[</span><span class="sr">ï¼š:</span><span class="se">]</span><span class="sr">.*/g</span><span class="p">,</span> <span class="dl">''</span><span class="p">)}</span><span class="s2">ã§æˆåŠŸã™ã‚‹ç§˜è¨£

</span><span class="p">${</span><span class="nx">dailyProposal</span><span class="p">.</span><span class="nx">topic</span><span class="p">}</span><span class="s2">ã‚’æˆåŠŸã•ã›ã‚‹ãŸã‚ã«ã¯ã€é¡§å®¢ã®æ·±å±¤å¿ƒç†ã‚’ç†è§£ã—ãŸã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒä¸å¯æ¬ ã§ã™ã€‚LeadFiveã®8ã¤ã®æœ¬èƒ½ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°æ‰‹æ³•ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€ç«¶åˆä»–ç¤¾ã¨ã®æ˜ç¢ºãªå·®åˆ¥åŒ–ã‚’å®Ÿç¾ã§ãã¾ã™ã€‚

### ğŸš€ LeadFiveã§ã•ã‚‰ã«åŠ¹æœã‚’æœ€å¤§åŒ–

LeadFiveã§ã¯ã€ã‚ãªãŸã®ãƒ“ã‚¸ãƒã‚¹ã«ç‰¹åŒ–ã—ãŸAIÃ—å¿ƒç†å­¦ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã‚µãƒãƒ¼ãƒˆã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚ä»Šå›ã”ç´¹ä»‹ã—ãŸæ‰‹æ³•ã®å®Ÿè£…ã‹ã‚‰æœ€é©åŒ–ã¾ã§ã€ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§ç¢ºå®Ÿãªæˆæœã‚’å®Ÿç¾ã—ã¾ã™ã€‚

**ç„¡æ–™ç›¸è«‡ã§ã€ã‚ãªãŸã®ãƒ“ã‚¸ãƒã‚¹ã«æœ€é©ãªæˆ¦ç•¥ã‚’ã”ææ¡ˆã„ãŸã—ã¾ã™ã€‚**

---

**ã“ã®è¨˜äº‹ã¯AIÃ—å¿ƒç†å­¦ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã®å°‚é–€ä¼æ¥­LeadFiveãŒã€æœ€æ–°ã®ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æã¨è±Šå¯Œãªå®Ÿä¾‹ã‚’åŸºã«ä½œæˆã—ã¾ã—ãŸã€‚**`</span><span class="p">;</span>

  <span class="k">return</span> <span class="nx">content</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// ===== ğŸ¨ Unsplash æœ€é©åŒ–ç”»åƒé¸æŠ =====</span>
<span class="kd">function</span> <span class="nx">selectOptimalImageFromUnsplash</span><span class="p">(</span><span class="nx">topic</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">CONFIG</span><span class="p">.</span><span class="nx">unsplashApiKey</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">âš ï¸ Unsplash APIã‚­ãƒ¼æœªè¨­å®š</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">return</span> <span class="dl">'</span><span class="s1">https://images.unsplash.com/photo-1551434678-e076c223a692?w=1200&amp;h=630&amp;fit=crop</span><span class="dl">'</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">try</span> <span class="p">{</span>
    <span class="c1">// ãƒˆãƒ”ãƒƒã‚¯ã‹ã‚‰ç”»åƒã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æŠ½å‡º</span>
    <span class="kd">const</span> <span class="nx">imageKeywords</span> <span class="o">=</span> <span class="nx">extractImageKeywords</span><span class="p">(</span><span class="nx">topic</span><span class="p">);</span>
    
    <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nx">fetch</span><span class="p">(</span>
      <span class="s2">`https://api.unsplash.com/search/photos?query=</span><span class="p">${</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">imageKeywords</span><span class="p">)}</span><span class="s2">&amp;per_page=10&amp;orientation=landscape`</span><span class="p">,</span>
      <span class="p">{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
          <span class="dl">'</span><span class="s1">Authorization</span><span class="dl">'</span><span class="p">:</span> <span class="s2">`Client-ID </span><span class="p">${</span><span class="nx">CONFIG</span><span class="p">.</span><span class="nx">unsplashApiKey</span><span class="p">}</span><span class="s2">`</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">);</span>
    
    <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">getContentText</span><span class="p">());</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">results</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">results</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// æœ€ã‚‚é©åˆ‡ãªç”»åƒã‚’é¸æŠï¼ˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ•°ã€ã„ã„ã­æ•°ã‚’è€ƒæ…®ï¼‰</span>
      <span class="kd">const</span> <span class="nx">bestImage</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">results</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">best</span><span class="p">,</span> <span class="nx">current</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">bestScore</span> <span class="o">=</span> <span class="p">(</span><span class="nx">best</span><span class="p">.</span><span class="nx">downloads</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">best</span><span class="p">.</span><span class="nx">likes</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">currentScore</span> <span class="o">=</span> <span class="p">(</span><span class="nx">current</span><span class="p">.</span><span class="nx">downloads</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">current</span><span class="p">.</span><span class="nx">likes</span> <span class="o">||</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">currentScore</span> <span class="o">&gt;</span> <span class="nx">bestScore</span> <span class="p">?</span> <span class="nx">current</span> <span class="p">:</span> <span class="nx">best</span><span class="p">;</span>
      <span class="p">});</span>
      
      <span class="kd">const</span> <span class="nx">optimizedUrl</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">bestImage</span><span class="p">.</span><span class="nx">urls</span><span class="p">.</span><span class="nx">raw</span><span class="p">}</span><span class="s2">&amp;w=</span><span class="p">${</span><span class="nx">CONFIG</span><span class="p">.</span><span class="nx">imageWidth</span><span class="p">}</span><span class="s2">&amp;h=</span><span class="p">${</span><span class="nx">CONFIG</span><span class="p">.</span><span class="nx">imageHeight</span><span class="p">}</span><span class="s2">&amp;fit=crop&amp;crop=smart`</span><span class="p">;</span>
      
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">âœ… Unsplashæœ€é©åŒ–ç”»åƒé¸æŠå®Œäº†:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">optimizedUrl</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">optimizedUrl</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">âŒ Unsplashç”»åƒé¸æŠã‚¨ãƒ©ãƒ¼:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>
  
  <span class="c1">// ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”»åƒ</span>
  <span class="k">return</span> <span class="dl">'</span><span class="s1">https://images.unsplash.com/photo-1551434678-e076c223a692?w=1200&amp;h=630&amp;fit=crop</span><span class="dl">'</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// ===== ğŸ”— å†…éƒ¨ãƒªãƒ³ã‚¯æœ€é©åŒ–ã‚·ã‚¹ãƒ†ãƒ  =====</span>
<span class="kd">function</span> <span class="nx">optimizeInternalLinks</span><span class="p">(</span><span class="nx">content</span><span class="p">,</span> <span class="nx">currentTopic</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// æ—¢å­˜è¨˜äº‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆå®Ÿéš›ã«ã¯GitHub APIã§å–å¾—ï¼‰</span>
  <span class="kd">const</span> <span class="nx">existingPosts</span> <span class="o">=</span> <span class="nx">getExistingBlogPosts</span><span class="p">();</span>
  
  <span class="c1">// é–¢é€£è¨˜äº‹ã‚’åˆ†æ</span>
  <span class="kd">const</span> <span class="nx">relatedPosts</span> <span class="o">=</span> <span class="nx">findRelatedPosts</span><span class="p">(</span><span class="nx">currentTopic</span><span class="p">,</span> <span class="nx">existingPosts</span><span class="p">);</span>
  
  <span class="c1">// ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«è‡ªç„¶ãªå†…éƒ¨ãƒªãƒ³ã‚¯ã‚’æŒ¿å…¥</span>
  <span class="kd">let</span> <span class="nx">optimizedContent</span> <span class="o">=</span> <span class="nx">content</span><span class="p">;</span>
  
  <span class="nx">relatedPosts</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">post</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// æœ€å¤§3ã¤ã®å†…éƒ¨ãƒªãƒ³ã‚¯</span>
      <span class="kd">const</span> <span class="nx">linkText</span> <span class="o">=</span> <span class="nx">generateNaturalLinkText</span><span class="p">(</span><span class="nx">post</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span> <span class="nx">currentTopic</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">linkHtml</span> <span class="o">=</span> <span class="s2">`&lt;a href="</span><span class="p">${</span><span class="nx">CONFIG</span><span class="p">.</span><span class="nx">blogBaseUrl</span><span class="p">}${</span><span class="nx">post</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span><span class="s2">" target="_blank" rel="noopener"&gt;</span><span class="p">${</span><span class="nx">linkText</span><span class="p">}</span><span class="s2">&lt;/a&gt;`</span><span class="p">;</span>
      
      <span class="c1">// ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å†…ã®é©åˆ‡ãªä½ç½®ã«ãƒªãƒ³ã‚¯ã‚’æŒ¿å…¥</span>
      <span class="nx">optimizedContent</span> <span class="o">=</span> <span class="nx">insertLinkNaturally</span><span class="p">(</span><span class="nx">optimizedContent</span><span class="p">,</span> <span class="nx">linkHtml</span><span class="p">,</span> <span class="nx">post</span><span class="p">.</span><span class="nx">keywords</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>
  
  <span class="k">return</span> <span class="nx">optimizedContent</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// ===== ğŸ”„ éå»è¨˜äº‹æ›´æ–°ã‚·ã‚¹ãƒ†ãƒ  =====</span>
<span class="kd">function</span> <span class="nx">updatePastArticlesWithNewLinks</span><span class="p">(</span><span class="nx">newTopic</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="c1">// æ–°è¨˜äº‹ã¨é–¢é€£æ€§ã®é«˜ã„éå»è¨˜äº‹ã‚’ç‰¹å®š</span>
    <span class="kd">const</span> <span class="nx">pastArticlesToUpdate</span> <span class="o">=</span> <span class="nx">identifyArticlesToUpdate</span><span class="p">(</span><span class="nx">newTopic</span><span class="p">);</span>
    
    <span class="nx">pastArticlesToUpdate</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">article</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="c1">// GitHub APIã§éå»è¨˜äº‹ã‚’æ›´æ–°</span>
      <span class="nx">updateArticleWithNewLink</span><span class="p">(</span><span class="nx">article</span><span class="p">,</span> <span class="nx">newTopic</span><span class="p">);</span>
    <span class="p">});</span>
    
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`âœ… </span><span class="p">${</span><span class="nx">pastArticlesToUpdate</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span><span class="s2">ä»¶ã®éå»è¨˜äº‹ã«å†…éƒ¨ãƒªãƒ³ã‚¯è¿½åŠ å®Œäº†`</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">âŒ éå»è¨˜äº‹æ›´æ–°ã‚¨ãƒ©ãƒ¼:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ===== ğŸ”— GitHub Actions ãƒˆãƒªã‚¬ãƒ¼ =====</span>
<span class="kd">function</span> <span class="nx">triggerGitHubActionsWithPremiumData</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">githubToken</span> <span class="o">=</span> <span class="nx">CONFIG</span><span class="p">.</span><span class="nx">githubToken</span><span class="p">;</span>
  
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">githubToken</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">âš ï¸ GitHub Token ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">payload</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">event_type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">create-blog-post</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">client_payload</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">proposal</span><span class="p">.</span><span class="nx">topic</span><span class="p">,</span>
        <span class="na">description</span><span class="p">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">proposal</span><span class="p">.</span><span class="nx">topic</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="na">category</span><span class="p">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">proposal</span><span class="p">.</span><span class="nx">aiSuggestion</span><span class="p">.</span><span class="nx">mainKeyword</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">||</span> <span class="dl">'</span><span class="s1">AIãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">target</span><span class="p">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">proposal</span><span class="p">.</span><span class="nx">weeklyTheme</span><span class="p">,</span>
        <span class="na">keywords</span><span class="p">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">proposal</span><span class="p">.</span><span class="nx">aiSuggestion</span><span class="p">.</span><span class="nx">relatedKeywords</span><span class="p">,</span>
        <span class="na">customInstruction</span><span class="p">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">customInstruction</span> <span class="o">||</span> <span class="dl">''</span><span class="p">,</span>
        <span class="na">content</span><span class="p">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">content</span><span class="p">,</span>
        <span class="na">optimizedImageUrl</span><span class="p">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">image</span><span class="p">,</span>
        <span class="na">weeklyTheme</span><span class="p">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">proposal</span><span class="p">.</span><span class="nx">weeklyTheme</span><span class="p">,</span>
        <span class="na">timestamp</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">(),</span>
        <span class="na">urgency</span><span class="p">:</span> <span class="dl">'</span><span class="s1">é«˜</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">buzzScore</span><span class="p">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">proposal</span><span class="p">.</span><span class="nx">aiSuggestion</span><span class="p">.</span><span class="nx">difficulty</span> <span class="o">*</span> <span class="mi">10</span>
      <span class="p">}</span>
    <span class="p">};</span>
    
    <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nx">fetch</span><span class="p">(</span>
      <span class="s2">`https://api.github.com/repos/</span><span class="p">${</span><span class="nx">CONFIG</span><span class="p">.</span><span class="nx">githubOwner</span><span class="p">}</span><span class="s2">/</span><span class="p">${</span><span class="nx">CONFIG</span><span class="p">.</span><span class="nx">githubRepo</span><span class="p">}</span><span class="s2">/dispatches`</span><span class="p">,</span>
      <span class="p">{</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
          <span class="dl">'</span><span class="s1">Authorization</span><span class="dl">'</span><span class="p">:</span> <span class="s2">`Bearer </span><span class="p">${</span><span class="nx">githubToken</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
          <span class="dl">'</span><span class="s1">Accept</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/vnd.github.v3+json</span><span class="dl">'</span><span class="p">,</span>
          <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span>
        <span class="p">},</span>
        <span class="na">payload</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">payload</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">);</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">getResponseCode</span><span class="p">()</span> <span class="o">===</span> <span class="mi">204</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">âœ… GitHub Actions ãƒˆãƒªã‚¬ãƒ¼æˆåŠŸ</span><span class="dl">'</span><span class="p">);</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">âŒ GitHub API ã‚¨ãƒ©ãƒ¼:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">getContentText</span><span class="p">());</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">âŒ GitHub Actions ãƒˆãƒªã‚¬ãƒ¼ã‚¨ãƒ©ãƒ¼:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ===== ğŸ“§ å®Œäº†é€šçŸ¥ãƒ¡ãƒ¼ãƒ« =====</span>
<span class="kd">function</span> <span class="nx">sendPremiumCompletionEmail</span><span class="p">(</span><span class="nx">proposal</span><span class="p">,</span> <span class="nx">customInstruction</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">timeStr</span> <span class="o">=</span> <span class="nx">Utilities</span><span class="p">.</span><span class="nx">formatDate</span><span class="p">(</span><span class="nx">now</span><span class="p">,</span> <span class="dl">'</span><span class="s1">JST</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">HH:mm</span><span class="dl">'</span><span class="p">);</span>
  
  <span class="kd">const</span> <span class="nx">htmlBody</span> <span class="o">=</span> <span class="s2">`
    &lt;div style="font-family: Arial, sans-serif; max-width: 500px; margin: 0 auto; padding: 20px;"&gt;
      &lt;div style="background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 25px; border-radius: 12px; text-align: center; margin-bottom: 20px;"&gt;
        &lt;h1 style="margin: 0; font-size: 24px;"&gt;âœ… è¨˜äº‹ä½œæˆé–‹å§‹ï¼&lt;/h1&gt;
        &lt;p style="margin: 10px 0 0 0; opacity: 0.9; font-size: 14px;"&gt;</span><span class="p">${</span><span class="nx">timeStr</span><span class="p">}</span><span class="s2"> å‡¦ç†é–‹å§‹&lt;/p&gt;
      &lt;/div&gt;
      
      &lt;div style="background: #f8fafc; padding: 20px; border-radius: 8px; margin-bottom: 20px;"&gt;
        &lt;h2 style="margin: 0 0 15px 0; color: #1e293b; font-size: 18px;"&gt;ğŸ“ é¸æŠã•ã‚ŒãŸè¨˜äº‹&lt;/h2&gt;
        &lt;p style="margin: 0 0 10px 0; font-weight: 600; color: #3730a3; font-size: 16px;"&gt;</span><span class="p">${</span><span class="nx">proposal</span><span class="p">.</span><span class="nx">topic</span><span class="p">}</span><span class="s2">&lt;/p&gt;
        </span><span class="p">${</span><span class="nx">customInstruction</span> <span class="p">?</span> <span class="s2">`
          &lt;div style="background: #e0f2fe; padding: 12px; border-radius: 6px; margin-top: 15px; border-left: 4px solid #0284c7;"&gt;
            &lt;strong style="color: #0c4a6e; font-size: 14px;"&gt;ğŸ› ï¸ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæŒ‡ç¤º:&lt;/strong&gt;
            &lt;p style="margin: 5px 0 0 0; color: #075985; font-size: 14px;"&gt;</span><span class="p">${</span><span class="nx">customInstruction</span><span class="p">}</span><span class="s2">&lt;/p&gt;
          &lt;/div&gt;
        `</span> <span class="p">:</span> <span class="dl">''</span><span class="p">}</span><span class="s2">
      &lt;/div&gt;
      
      &lt;div style="background: #fef3c7; padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b; margin-bottom: 20px;"&gt;
        &lt;p style="margin: 0; color: #92400e; font-size: 14px;"&gt;
          â±ï¸ &lt;strong&gt;äºˆå®šæ™‚åˆ»:&lt;/strong&gt; 10-15åˆ†å¾Œã«GitHubã«æŠ•ç¨¿ã•ã‚Œã¾ã™
        &lt;/p&gt;
      &lt;/div&gt;
      
      &lt;div style="text-align: center;"&gt;
        &lt;a href="https://github.com/</span><span class="p">${</span><span class="nx">CONFIG</span><span class="p">.</span><span class="nx">githubOwner</span><span class="p">}</span><span class="s2">/</span><span class="p">${</span><span class="nx">CONFIG</span><span class="p">.</span><span class="nx">githubRepo</span><span class="p">}</span><span class="s2">" 
           style="background: #8b5cf6; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block; font-weight: 600;"&gt;
          GitHubã§ç¢ºèª â†’
        &lt;/a&gt;
      &lt;/div&gt;
      
      &lt;p style="text-align: center; color: #64748b; font-size: 12px; margin-top: 20px;"&gt;
        ğŸ¤– LeadFive Premium AI Blog System
      &lt;/p&gt;
    &lt;/div&gt;
  `</span><span class="p">;</span>
  
  <span class="k">try</span> <span class="p">{</span>
    <span class="nx">MailApp</span><span class="p">.</span><span class="nx">sendEmail</span><span class="p">({</span>
      <span class="na">to</span><span class="p">:</span> <span class="nx">CONFIG</span><span class="p">.</span><span class="nx">recipientEmail</span><span class="p">,</span>
      <span class="na">subject</span><span class="p">:</span> <span class="dl">'</span><span class="s1">âœ… ãƒ–ãƒ­ã‚°è¨˜äº‹ä½œæˆé–‹å§‹ - LeadFive Premium AI</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">htmlBody</span><span class="p">:</span> <span class="nx">htmlBody</span><span class="p">,</span>
      <span class="na">name</span><span class="p">:</span> <span class="nx">CONFIG</span><span class="p">.</span><span class="nx">botName</span>
    <span class="p">});</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">âœ… å®Œäº†é€šçŸ¥ãƒ¡ãƒ¼ãƒ«é€ä¿¡å®Œäº†</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">âŒ å®Œäº†é€šçŸ¥ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã‚¨ãƒ©ãƒ¼:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ===== ğŸ“§ ã‚¹ã‚­ãƒƒãƒ—ç¢ºèªãƒ¡ãƒ¼ãƒ« =====</span>
<span class="kd">function</span> <span class="nx">sendSkipConfirmation</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">timeStr</span> <span class="o">=</span> <span class="nx">Utilities</span><span class="p">.</span><span class="nx">formatDate</span><span class="p">(</span><span class="nx">now</span><span class="p">,</span> <span class="dl">'</span><span class="s1">JST</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">HH:mm</span><span class="dl">'</span><span class="p">);</span>
  
  <span class="kd">const</span> <span class="nx">htmlBody</span> <span class="o">=</span> <span class="s2">`
    &lt;div style="font-family: Arial, sans-serif; max-width: 400px; margin: 0 auto; padding: 20px;"&gt;
      &lt;div style="background: #fee2e2; color: #991b1b; padding: 20px; border-radius: 10px; text-align: center;"&gt;
        &lt;h2 style="margin: 0;"&gt;â­ï¸ æœ¬æ—¥ã®æŠ•ç¨¿ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã—ãŸ&lt;/h2&gt;
        &lt;p style="margin: 10px 0 0 0; font-size: 14px;"&gt;</span><span class="p">${</span><span class="nx">timeStr</span><span class="p">}</span><span class="s2"> ç¢ºèªæ¸ˆã¿&lt;/p&gt;
      &lt;/div&gt;
      &lt;p style="text-align: center; color: #64748b; font-size: 12px; margin-top: 20px;"&gt;
        æ˜æ—¥ã‚‚æœ8æ™‚ã«ç¢ºèªãƒ¡ãƒ¼ãƒ«ã‚’ãŠé€ã‚Šã—ã¾ã™
      &lt;/p&gt;
    &lt;/div&gt;
  `</span><span class="p">;</span>
  
  <span class="k">try</span> <span class="p">{</span>
    <span class="nx">MailApp</span><span class="p">.</span><span class="nx">sendEmail</span><span class="p">({</span>
      <span class="na">to</span><span class="p">:</span> <span class="nx">CONFIG</span><span class="p">.</span><span class="nx">recipientEmail</span><span class="p">,</span>
      <span class="na">subject</span><span class="p">:</span> <span class="dl">'</span><span class="s1">â­ï¸ æœ¬æ—¥ã®æŠ•ç¨¿ã‚¹ã‚­ãƒƒãƒ—ç¢ºèª</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">htmlBody</span><span class="p">:</span> <span class="nx">htmlBody</span><span class="p">,</span>
      <span class="na">name</span><span class="p">:</span> <span class="nx">CONFIG</span><span class="p">.</span><span class="nx">botName</span>
    <span class="p">});</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">âŒ ã‚¹ã‚­ãƒƒãƒ—ç¢ºèªãƒ¡ãƒ¼ãƒ«é€ä¿¡ã‚¨ãƒ©ãƒ¼:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ===== â° è‡ªå‹•ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°è¨­å®š =====</span>
<span class="kd">function</span> <span class="nx">setupPremiumScheduling</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// æ—¢å­˜ãƒˆãƒªã‚¬ãƒ¼ã‚’å‰Šé™¤</span>
  <span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">getProjectTriggers</span><span class="p">().</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">trigger</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">deleteTrigger</span><span class="p">(</span><span class="nx">trigger</span><span class="p">);</span>
  <span class="p">});</span>
  
  <span class="k">try</span> <span class="p">{</span>
    <span class="c1">// æ¯æ—¥æœ8æ™‚ã«ç¢ºèªãƒ¡ãƒ¼ãƒ«é€ä¿¡</span>
    <span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">newTrigger</span><span class="p">(</span><span class="dl">'</span><span class="s1">sendDailyContentConfirmation</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">timeBased</span><span class="p">()</span>
      <span class="p">.</span><span class="nx">atHour</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">everyDays</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">create</span><span class="p">();</span>
    
    <span class="c1">// 5åˆ†ã”ã¨ã«è¿”ä¿¡ãƒã‚§ãƒƒã‚¯</span>
    <span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">newTrigger</span><span class="p">(</span><span class="dl">'</span><span class="s1">processDailyConfirmationReplies</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">timeBased</span><span class="p">()</span>
      <span class="p">.</span><span class="nx">everyMinutes</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">create</span><span class="p">();</span>
    
    <span class="c1">// æ¯é€±æœˆæ›œæ—¥ã«æ–°ã—ã„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ©ãƒ³ä½œæˆ</span>
    <span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">newTrigger</span><span class="p">(</span><span class="dl">'</span><span class="s1">createWeeklyContentPlan</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">timeBased</span><span class="p">()</span>
      <span class="p">.</span><span class="nx">onWeekDay</span><span class="p">(</span><span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">WeekDay</span><span class="p">.</span><span class="nx">MONDAY</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">atHour</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">create</span><span class="p">();</span>
    
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">âœ… ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°è¨­å®šå®Œäº†</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">âŒ ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°è¨­å®šã‚¨ãƒ©ãƒ¼:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// ===== ğŸ“Š ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•° =====</span>
<span class="kd">function</span> <span class="nx">getWeekNumber</span><span class="p">(</span><span class="nx">date</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">firstDayOfYear</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">date</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">pastDaysOfYear</span> <span class="o">=</span> <span class="p">(</span><span class="nx">date</span> <span class="o">-</span> <span class="nx">firstDayOfYear</span><span class="p">)</span> <span class="o">/</span> <span class="mi">86400000</span><span class="p">;</span>
  <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">((</span><span class="nx">pastDaysOfYear</span> <span class="o">+</span> <span class="nx">firstDayOfYear</span><span class="p">.</span><span class="nx">getDay</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">7</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">extractImageKeywords</span><span class="p">(</span><span class="nx">topic</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// AIãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°é–¢é€£ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒ”ãƒ³ã‚°</span>
  <span class="kd">const</span> <span class="nx">keywordMap</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">ChatGPT</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">artificial intelligence technology</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">AI</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">artificial intelligence futuristic</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">digital marketing business</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">ç¾å®¹</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">beauty salon skincare</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">ãƒ‡ãƒ¼ã‚¿åˆ†æ</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">data analytics dashboard</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">SNS</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">social media marketing</span><span class="dl">'</span><span class="p">,</span>
  <span class="p">};</span>
  
  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="p">[</span><span class="nx">japanese</span><span class="p">,</span> <span class="nx">english</span><span class="p">]</span> <span class="k">of</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">entries</span><span class="p">(</span><span class="nx">keywordMap</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">topic</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">japanese</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">english</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="k">return</span> <span class="dl">'</span><span class="s1">digital marketing technology</span><span class="dl">'</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">extractCustomInstruction</span><span class="p">(</span><span class="nx">bodyText</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">lines</span> <span class="o">=</span> <span class="nx">bodyText</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="se">\\</span><span class="s1">n</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">firstLine</span> <span class="o">=</span> <span class="nx">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">trim</span><span class="p">();</span>
  
  <span class="k">if</span> <span class="p">(</span><span class="nx">firstLine</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">OK</span><span class="dl">'</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">firstLine</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">firstLine</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^OK</span><span class="se">\s</span><span class="sr">*/i</span><span class="p">,</span> <span class="dl">''</span><span class="p">).</span><span class="nx">trim</span><span class="p">();</span>
  <span class="p">}</span>
  
  <span class="k">return</span> <span class="dl">''</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">analyzeFocusArea</span><span class="p">(</span><span class="nx">customInstruction</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">customInstruction</span><span class="p">)</span> <span class="k">return</span> <span class="dl">''</span><span class="p">;</span>
  
  <span class="kd">const</span> <span class="nx">instruction</span> <span class="o">=</span> <span class="nx">customInstruction</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
  
  <span class="k">if</span> <span class="p">(</span><span class="nx">instruction</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">ãƒ‡ãƒ¼ã‚¿</span><span class="dl">'</span><span class="p">)</span> <span class="o">||</span> <span class="nx">instruction</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">çµ±è¨ˆ</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="dl">'</span><span class="s1">ãƒ‡ãƒ¼ã‚¿ãƒ»çµ±è¨ˆé‡è¦–ã®å†…å®¹ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™</span><span class="dl">'</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">instruction</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">äº‹ä¾‹</span><span class="dl">'</span><span class="p">)</span> <span class="o">||</span> <span class="nx">instruction</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">ã‚±ãƒ¼ã‚¹</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="dl">'</span><span class="s1">å®Ÿä¾‹ãƒ»ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£ã‚’ä¸­å¿ƒã«æ§‹æˆã•ã‚Œã¦ã„ã¾ã™</span><span class="dl">'</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">instruction</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">ç¾å®¹</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="dl">'</span><span class="s1">ç¾å®¹æ¥­ç•Œã«ç‰¹åŒ–ã—ãŸå†…å®¹ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™</span><span class="dl">'</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">instruction</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">åˆå¿ƒè€…</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="dl">'</span><span class="s1">åˆå¿ƒè€…å‘ã‘ã«åŸºæœ¬ã‹ã‚‰ä¸å¯§ã«è§£èª¬ã—ã¾ã™</span><span class="dl">'</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">instruction</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">å®Ÿè·µ</span><span class="dl">'</span><span class="p">)</span> <span class="o">||</span> <span class="nx">instruction</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">æ‰‹é †</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="dl">'</span><span class="s1">å®Ÿè·µçš„ãªæ‰‹é †ã‚’é‡è¦–ã—ãŸæ§‹æˆã«ãªã£ã¦ã„ã¾ã™</span><span class="dl">'</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">return</span> <span class="dl">''</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// ===== ğŸ”— å†…éƒ¨ãƒªãƒ³ã‚¯é–¢é€£ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ =====</span>
<span class="kd">function</span> <span class="nx">getExistingBlogPosts</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// å®Ÿéš›ã«ã¯GitHub APIã§å–å¾—</span>
  <span class="k">return</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="na">title</span><span class="p">:</span> <span class="dl">"</span><span class="s2">AIãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°å®Œå…¨ã‚¬ã‚¤ãƒ‰</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">/blog/2024-01-15-ai-marketing-guide</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">keywords</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">AI</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">è‡ªå‹•åŒ–</span><span class="dl">"</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="na">title</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ç¾å®¹æ¥­ç•Œã®ãƒ‡ã‚¸ã‚¿ãƒ«å¤‰é©</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">url</span><span class="p">:</span> <span class="dl">"</span><span class="s2">/blog/2024-01-10-beauty-digital-transformation</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">keywords</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">ç¾å®¹</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">ãƒ‡ã‚¸ã‚¿ãƒ«</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">å¤‰é©</span><span class="dl">"</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">];</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">findRelatedPosts</span><span class="p">(</span><span class="nx">currentTopic</span><span class="p">,</span> <span class="nx">existingPosts</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒãƒ³ã‚°ã§é–¢é€£è¨˜äº‹ã‚’ç‰¹å®š</span>
  <span class="k">return</span> <span class="nx">existingPosts</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">post</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">post</span><span class="p">.</span><span class="nx">keywords</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">keyword</span> <span class="o">=&gt;</span> 
      <span class="nx">currentTopic</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">keyword</span><span class="p">)</span>
    <span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">generateNaturalLinkText</span><span class="p">(</span><span class="nx">postTitle</span><span class="p">,</span> <span class="nx">currentTopic</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">postTitle</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">insertLinkNaturally</span><span class="p">(</span><span class="nx">content</span><span class="p">,</span> <span class="nx">linkHtml</span><span class="p">,</span> <span class="nx">keywords</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// å®Ÿéš›ã«ã¯è‡ªç„¶ãªä½ç½®ã«ãƒªãƒ³ã‚¯ã‚’æŒ¿å…¥</span>
  <span class="k">return</span> <span class="nx">content</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">identifyArticlesToUpdate</span><span class="p">(</span><span class="nx">newTopic</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// å®Ÿéš›ã«ã¯GitHub APIã§éå»è¨˜äº‹ã‚’åˆ†æ</span>
  <span class="k">return</span> <span class="p">[];</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">updateArticleWithNewLink</span><span class="p">(</span><span class="nx">article</span><span class="p">,</span> <span class="nx">newTopic</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// å®Ÿéš›ã«ã¯GitHub APIã§è¨˜äº‹ã‚’æ›´æ–°</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`è¨˜äº‹æ›´æ–°ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³: </span><span class="p">${</span><span class="nx">article</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// ===== ğŸ§ª ãƒ¡ã‚¤ãƒ³å®Ÿè¡Œé–¢æ•° =====</span>
<span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">LeadFive Premium AI Blog System èµ·å‹•</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">sendDailyContentConfirmation</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="-å¿…è¦ãªå®Ÿè¡Œæ‰‹é †">ğŸ¯ å¿…è¦ãªå®Ÿè¡Œæ‰‹é †</h2>

<ol>
  <li><strong>æ¨©é™è¨­å®šã‚’ä¿®æ­£</strong>
    <ul>
      <li>appsscript.json ã«Gmailæ¨©é™ã‚’è¿½åŠ </li>
    </ul>
  </li>
  <li><strong>ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ã‚’é–‹å§‹</strong>
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">setupPremiumScheduling</span><span class="p">()</span>
</code></pre></div>    </div>
  </li>
  <li><strong>æ‰‹å‹•ã§ãƒ†ã‚¹ãƒˆé€ä¿¡</strong>
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">sendDailyContentConfirmation</span><span class="p">()</span>
</code></pre></div>    </div>
  </li>
</ol>

<p>ã“ã‚ŒãŒå®Œå…¨ãªæœ€çµ‚ç‰ˆã‚³ãƒ¼ãƒ‰ã§ã™ã€‚ãƒ†ã‚¹ãƒˆé–¢æ•°ã¯ã™ã¹ã¦å‰Šé™¤ã—ã€æœ¬ç•ªé‹ç”¨ã«å¿…è¦ãªæ©Ÿèƒ½ã®ã¿ã‚’æ®‹ã—ã¾ã—ãŸã€‚</p>

  </main>
  
  <footer class="site-footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-section">
        <h3>åˆåŒä¼šç¤¾Leadfive</h3>
        <p>äººé–“ã®8ã¤ã®æœ¬èƒ½ã‚’ç†è§£ã—ã€AIã§æœ€é©åŒ–ã€‚äºˆæ¸¬å¯èƒ½ãªæˆé•·ã‚’ã‚ãªãŸã®ãƒ“ã‚¸ãƒã‚¹ã«ã€‚</p>
        <div class="company-info">
          <p>ã€’530-0001</p>
          <p>å¤§é˜ªåºœå¤§é˜ªå¸‚åŒ—åŒºæ¢…ç”°ï¼‘ï¼ï¼‘ï¼“ï¼ï¼‘</p>
          <p>å¤§é˜ªæ¢…ç”°ãƒ„ã‚¤ãƒ³ã‚¿ãƒ¯ãƒ¼ã‚ºãƒ»ã‚µã‚¦ã‚¹ï¼‘ï¼•éš</p>
          <p>TEL: <a href="tel:06-7713-6747">06-7713-6747</a></p>
          <p>EMAIL: <a href="mailto:leadfive.138@gmail.com">leadfive.138@gmail.com</a></p>
        </div>
        <div class="social-links">
          <a href="https://x.com/leadfive138" target="_blank" rel="noopener" aria-label="X (Twitter)">
            <svg class="social-icon" viewBox="0 0 24 24">
              <path d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z"/>
            </svg>
          </a>
        </div>
      </div>
      
      <div class="footer-section">
        <h4>ã‚µãƒ¼ãƒ“ã‚¹</h4>
        <ul class="footer-links">
          <li><a href="/services/lp-optimization/">AIÃ—å¿ƒç†å­¦ LPæœ€é©åŒ–</a></li>
          <li><a href="/services/customer-analysis/">é¡§å®¢å¿ƒç†ãƒ‡ãƒ¼ã‚¿åˆ†æ</a></li>
          <li><a href="/services/ai-automation/">AIè‡ªå‹•åŒ–ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°</a></li>
          <li><a href="/services/integrated-marketing/">çµ±åˆãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°æˆ¦ç•¥</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ä¼šç¤¾æƒ…å ±</h4>
        <ul class="footer-links">
          <li><a href="/company/">ä¼šç¤¾æ¦‚è¦</a></li>
          <li><a href="/company/#mission">ãƒŸãƒƒã‚·ãƒ§ãƒ³</a></li>
          <li><a href="/company/#access">ã‚¢ã‚¯ã‚»ã‚¹</a></li>
          <li><a href="#" onclick="openContactForm(); return false;">ãŠå•ã„åˆã‚ã›</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ãƒªã‚½ãƒ¼ã‚¹</h4>
        <ul class="footer-links">
          <li><a href="/blog/">ãƒ–ãƒ­ã‚°</a></li>
          <li><a href="/case-studies/">å°å…¥äº‹ä¾‹</a></li>
          <!-- <li><a href="/resources/whitepaper/">ãƒ›ãƒ¯ã‚¤ãƒˆãƒšãƒ¼ãƒ‘ãƒ¼</a></li> -->
          <li><a href="/privacy/">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a></li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2025 åˆåŒä¼šç¤¾Leadfive. All rights reserved.</p>
    </div>
  </div>
</footer>
  
  <!-- Contact Modal -->
  <div id="contact-modal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeContactModal()">&times;</span>
      <div class="modal-header">
        <h2>ãŠå•ã„åˆã‚ã›</h2>
        <p>ãŠæ°—è»½ã«ã”ç›¸è«‡ãã ã•ã„ã€‚1-2å–¶æ¥­æ—¥ä»¥å†…ã«ã”è¿”ä¿¡ã„ãŸã—ã¾ã™ã€‚</p>
      </div>
      <div class="modal-body">
        <form id="contactModalForm" class="contact-form">
          <div class="form-row">
            <div class="form-group">
              <label for="modal-company">ä¼šç¤¾å <span class="required">*</span></label>
              <input type="text" id="modal-company" name="company" required placeholder="æ ªå¼ä¼šç¤¾ã€‡ã€‡">
            </div>
            <div class="form-group">
              <label for="modal-name">ãŠåå‰ <span class="required">*</span></label>
              <input type="text" id="modal-name" name="name" required placeholder="å±±ç”° å¤ªéƒ">
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label for="modal-email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ <span class="required">*</span></label>
              <input type="email" id="modal-email" name="email" required placeholder="example@company.com">
            </div>
            <div class="form-group">
              <label for="modal-phone">é›»è©±ç•ªå·</label>
              <input type="tel" id="modal-phone" name="phone" placeholder="06-1234-5678">
            </div>
          </div>
          
          <div class="form-group">
            <label for="modal-inquiry-type">ãŠå•ã„åˆã‚ã›ç¨®åˆ¥ <span class="required">*</span></label>
            <select id="modal-inquiry-type" name="inquiry_type" required>
              <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
              <option value="service">ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦</option>
              <option value="consultation">ç„¡æ–™ç›¸è«‡ã®ç”³ã—è¾¼ã¿</option>
              <option value="quotation">è¦‹ç©ã‚‚ã‚Šä¾é ¼</option>
              <option value="other">ãã®ä»–</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="modal-message">ãŠå•ã„åˆã‚ã›å†…å®¹ <span class="required">*</span></label>
            <textarea id="modal-message" name="message" rows="5" required placeholder="ãŠå•ã„åˆã‚ã›å†…å®¹ã‚’ã”è¨˜å…¥ãã ã•ã„"></textarea>
          </div>
          
          <div class="form-group checkbox-group">
            <label>
              <input type="checkbox" name="privacy" value="agreed" required>
              <span><a href="/privacy/" target="_blank">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>ã«åŒæ„ã™ã‚‹</span>
            </label>
          </div>
          
          <button type="submit" class="btn btn-primary btn-large">é€ä¿¡ã™ã‚‹</button>
        </form>
      </div>
    </div>
  </div>
  
  <!-- AI Analysis Modal -->
  <div id="ai-analysis-modal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeAIAnalysis()">&times;</span>
      <h2 style="text-align: center;">ç„¡æ–™AIåˆ†æè¨ºæ–­</h2>
      <p style="text-align: center;">ã‚ãªãŸã®ãƒ“ã‚¸ãƒã‚¹ã«æœ€é©ãªæˆ¦ç•¥ã‚’30ç§’ã§è¨ºæ–­ã—ã¾ã™</p>
      
      <form class="ai-analysis-form">
        <div class="form-group">
          <label for="business-type">æ¥­ç¨®ã‚’é¸æŠã—ã¦ãã ã•ã„</label>
          <select id="business-type" name="business-type" required>
            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
            <option value="ec">ECãƒ»ã‚ªãƒ³ãƒ©ã‚¤ãƒ³è²©å£²</option>
            <option value="retail">å®Ÿåº—èˆ—ãƒ»å°å£²</option>
            <option value="service">ã‚µãƒ¼ãƒ“ã‚¹æ¥­</option>
            <option value="btob">BtoBãƒ»æ³•äººå‘ã‘</option>
            <option value="beauty">ç¾å®¹ãƒ»ã‚µãƒ­ãƒ³</option>
            <option value="consulting">ã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°</option>
            <option value="other">ãã®ä»–</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="monthly-revenue">æœˆé–“å£²ä¸Šè¦æ¨¡</label>
          <select id="monthly-revenue" name="monthly-revenue" required>
            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
            <option value="under-100">100ä¸‡å††æœªæº€</option>
            <option value="100-500">100ä¸‡å††ã€œ500ä¸‡å††</option>
            <option value="500-1000">500ä¸‡å††ã€œ1000ä¸‡å††</option>
            <option value="1000-5000">1000ä¸‡å††ã€œ5000ä¸‡å††</option>
            <option value="over-5000">5000ä¸‡å††ä»¥ä¸Š</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="main-challenge">æœ€ã‚‚å¤§ããªèª²é¡Œ</label>
          <select id="main-challenge" name="main-challenge" required>
            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
            <option value="traffic">é›†å®¢ãƒ»ã‚¢ã‚¯ã‚»ã‚¹æ•°ã®ä¸è¶³</option>
            <option value="conversion">æˆç´„ç‡ãƒ»CVRã®ä½ã•</option>
            <option value="retention">ãƒªãƒ”ãƒ¼ã‚¿ãƒ¼ãƒ»LTVå‘ä¸Š</option>
            <option value="cost">åºƒå‘Šè²»ãƒ»ç²å¾—ã‚³ã‚¹ãƒˆã®é«˜é¨°</option>
            <option value="analysis">ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ»æ”¹å–„æ–¹æ³•</option>
            <option value="automation">æ¥­å‹™åŠ¹ç‡ãƒ»è‡ªå‹•åŒ–</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆçµæœé€ä¿¡ç”¨ï¼‰</label>
          <input type="email" id="email" name="email" placeholder="example@company.com" required>
        </div>
        
        <div style="text-align: center;">
          <button type="submit" class="btn btn-primary btn-large">
            ç„¡æ–™ã§è¨ºæ–­çµæœã‚’å—ã‘å–ã‚‹
          </button>
        </div>
      </form>
      
      <p class="privacy-note">
        â€»è¨ºæ–­çµæœã¯å…¥åŠ›ã„ãŸã ã„ãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã«é€ä¿¡ã•ã‚Œã¾ã™<br>
        â€»å€‹äººæƒ…å ±ã¯å³é‡ã«ç®¡ç†ã—ã€ç¬¬ä¸‰è€…ã«æä¾›ã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“
      </p>
    </div>
  </div>
  
  <style>
  .ai-analysis-form {
    margin-top: 2rem;
  }
  
  .ai-analysis-form .form-group {
    margin-bottom: 1.5rem;
  }
  
  .ai-analysis-form .form-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: #fff;
  }
  
  .ai-analysis-form .form-group select,
  .ai-analysis-form .form-group input {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.1);
    color: #fff;
    font-size: 1rem;
  }
  
  .ai-analysis-form .form-group select:focus,
  .ai-analysis-form .form-group input:focus {
    outline: none;
    border-color: #8b5cf6;
    box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.2);
  }
  
  .ai-analysis-form .form-group option {
    background: #1f2937;
    color: #fff;
  }
  
  .privacy-note {
    font-size: 0.75rem;
    color: #9ca3af;
    text-align: center;
    margin-top: 1rem;
    line-height: 1.4;
  }
  
  @media (max-width: 768px) {
    .modal-content {
      width: 95%;
      margin: 10% auto;
      padding: 1.5rem;
    }
    
    .ai-analysis-form .form-group select,
    .ai-analysis-form .form-group input {
      padding: 0.5rem;
      font-size: 0.875rem;
    }
  }
  </style>
  
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/contact-modal.js"></script>
  <script src="/assets/js/contact-handler-gas.js"></script>
  
</body>
</html>